/*
 Simditor v2.3.13
 http://simditor.tower.im/
 2018-03-09
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,m,t){d instanceof String&&(d=String(d));for(var u=d.length,n=0;n<u;n++){var x=d[n];if(m.call(t,x,n,d))return{i:n,v:x}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,m,t){d!=Array.prototype&&d!=Object.prototype&&(d[m]=t.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,m,t,u){if(m){t=$jscomp.global;d=d.split(".");for(u=0;u<d.length-1;u++){var n=d[u];n in t||(t[n]={});t=t[n]}d=d[d.length-1];u=t[d];m=m(u);m!=u&&null!=m&&$jscomp.defineProperty(t,d,{configurable:!0,writable:!0,value:m})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,t){return $jscomp.findInternal(this,d,t).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(m){return $jscomp.SYMBOL_PREFIX+(m||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var m=0;return $jscomp.iteratorPrototype(function(){return m<d.length?{done:!1,value:d[m++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.iteratorFromArray=function(d,m){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var t=0,u={next:function(){if(t<d.length){var n=t++;return{value:m(n,d[n]),done:!1}}u.next=function(){return{done:!0,value:void 0}};return u.next()}};u[Symbol.iterator]=function(){return u};return u};
$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6","es3");
(function(d,m){"function"===typeof define&&define.amd?define("simditor",["jquery","simple-module","simple-hotkeys","simple-uploader"],function(t,u,n,x){return d.Simditor=m(t,u,n,x)}):"object"===typeof exports?module.exports=m(require("jquery"),require("simple-module"),require("simple-hotkeys"),require("simple-uploader")):d.Simditor=m(jQuery,SimpleModule,simple.hotkeys,simple.uploader)})(this,function(d,m,t,u){var n=function(d,b){function a(){this.constructor=d}for(var c in b)x.call(b,c)&&(d[c]=b[c]);
a.prototype=b.prototype;d.prototype=new a;d.__super__=b.prototype;return d},x={}.hasOwnProperty,y=[].indexOf||function(d){for(var b=0,a=this.length;b<a;b++)if(b in this&&this[b]===d)return b;return-1},w=[].slice;var C=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="Selection";b.prototype._range=null;b.prototype._startNodes=null;b.prototype._endNodes=null;b.prototype._containerNode=null;b.prototype._nodes=null;b.prototype._blockNodes=null;b.prototype._rootNodes=
null;b.prototype._init=function(){this.editor=this._module;this._selection=document.getSelection();this.editor.on("selectionchanged",function(a){return function(c){a.reset();return a._range=a._selection.getRangeAt(0)}}(this));this.editor.on("blur",function(a){return function(c){return a.reset()}}(this));return this.editor.on("focus",function(a){return function(c){a.reset();return a._range=a._selection.getRangeAt(0)}}(this))};b.prototype.reset=function(){return this._rootNodes=this._blockNodes=this._nodes=
this._containerNode=this._endNodes=this._startNodes=this._range=null};b.prototype.clear=function(){try{this._selection.removeAllRanges()}catch(a){}return this.reset()};b.prototype.range=function(a){a?(this.clear(),this._selection.addRange(a),this._range=a,a=this.editor.util.browser.firefox||this.editor.util.browser.msie,!this.editor.inputManager.focused&&a&&this.editor.body.focus()):!this._range&&this.editor.inputManager.focused&&this._selection.rangeCount&&(this._range=this._selection.getRangeAt(0));
return this._range};b.prototype.startNodes=function(){this._range&&(this._startNodes||(this._startNodes=function(a){return function(){var c=d(a._range.startContainer).parentsUntil(a.editor.body).get();c.unshift(a._range.startContainer);return d(c)}}(this)()));return this._startNodes};b.prototype.endNodes=function(){var a;this._range&&(this._endNodes||(this._endNodes=this._range.collapsed?this.startNodes():(a=d(this._range.endContainer).parentsUntil(this.editor.body).get(),a.unshift(this._range.endContainer),
d(a))));return this._endNodes};b.prototype.containerNode=function(){this._range&&(this._containerNode||(this._containerNode=d(this._range.commonAncestorContainer)));return this._containerNode};b.prototype.nodes=function(){this._range&&(this._nodes||(this._nodes=function(a){return function(){var c=[];a.startNodes().first().is(a.endNodes().first())?c=a.startNodes().get():(a.startNodes().each(function(e,b){var g;e=d(b);if(-1<a.endNodes().index(e))return c.push(b);if(e.parent().is(a.editor.body)||-1<
(g=a.endNodes().index(e.parent())))return g=g&&-1<g?a.endNodes().eq(g-1):a.endNodes().last(),b=e.parent().contents(),e=b.index(e),g=b.index(g),d.merge(c,b.slice(e,g).get());b=e.parent().contents();e=b.index(e);return d.merge(c,b.slice(e).get())}),a.endNodes().each(function(e,b){e=d(b);if(e.parent().is(a.editor.body)||-1<a.startNodes().index(e.parent()))return c.push(b),!1;b=e.parent().contents();e=b.index(e);return d.merge(c,b.slice(0,e+1))}));return d(d.unique(c))}}(this)()));return this._nodes};
b.prototype.blockNodes=function(){if(this._range)return this._blockNodes||(this._blockNodes=function(a){return function(){return a.nodes().filter(function(c,e){return a.editor.util.isBlockNode(e)})}}(this)()),this._blockNodes};b.prototype.rootNodes=function(){if(this._range)return this._rootNodes||(this._rootNodes=function(a){return function(){return a.nodes().filter(function(c,e){c=d(e).parent();return c.is(a.editor.body)||c.is("blockquote")})}}(this)()),this._rootNodes};b.prototype.rangeAtEndOf=
function(a,c){null==c&&(c=this.range());if(c&&c.collapsed){a=d(a)[0];var e=c.endContainer;var b=this.editor.util.getNodeLength(e);var f=c.endOffset===b-1;var k=d(e).contents().last().is("br");c=c.endOffset===b;if(!(f&&k||c))return!1;if(a===e)return!0;if(!d.contains(a,e))return!1;var h=!0;d(e).parentsUntil(a).addBack().each(function(a,c){var e=d(c).parent().contents().filter(function(){return!(this!==c&&3===this.nodeType&&!this.nodeValue)}).last();a=e.get(0)===c;e=e.is("br")&&e.prev().get(0)===c;if(!a&&
!e)return h=!1});return h}};b.prototype.rangeAtStartOf=function(a,c){null==c&&(c=this.range());if(c&&c.collapsed){a=d(a)[0];var e=c.startContainer;if(0!==c.startOffset)return!1;if(a===e)return!0;if(!d.contains(a,e))return!1;var b=!0;d(e).parentsUntil(a).addBack().each(function(a,c){if(d(c).parent().contents().filter(function(){return!(this!==c&&3===this.nodeType&&!this.nodeValue)}).first().get(0)!==c)return b=!1});return b}};b.prototype.insertNode=function(a,c){null==c&&(c=this.range());if(c)return a=
d(a)[0],c.insertNode(a),this.setRangeAfter(a,c)};b.prototype.setRangeAfter=function(a,c){null==c&&(c=this.range());if(null!=c)return a=d(a)[0],c.setEndAfter(a),c.collapse(!1),this.range(c)};b.prototype.setRangeBefore=function(a,c){null==c&&(c=this.range());if(null!=c)return a=d(a)[0],c.setEndBefore(a),c.collapse(!1),this.range(c)};b.prototype.setRangeAtStartOf=function(a,c){null==c&&(c=this.range());a=d(a).get(0);c.setEnd(a,0);c.collapse(!1);return this.range(c)};b.prototype.setRangeAtEndOf=function(a,
c){null==c&&(c=this.range());var e=d(a);if(a=e[0]){if(e.is("pre"))if(e=e.contents(),0<e.length){a=e.last();var b=a.text();e=this.editor.util.getNodeLength(a[0]);"\n"===b.charAt(b.length-1)?c.setEnd(a[0],e-1):c.setEnd(a[0],e)}else c.setEnd(a,0);else b=this.editor.util.getNodeLength(a),3!==a.nodeType&&0<b&&(e=d(a).contents().last(),e.is("br")?--b:3!==e[0].nodeType&&this.editor.util.isEmptyNode(e)&&(e.append(this.editor.util.phBr),a=e[0],b=0)),c.setEnd(a,b);c.collapse(!1);return this.range(c)}};b.prototype.deleteRangeContents=
function(a){null==a&&(a=this.range());var c=a.cloneRange();var e=a.cloneRange();c.collapse(!0);e.collapse(!1);c=this.rangeAtStartOf(this.editor.body,c);e=this.rangeAtEndOf(this.editor.body,e);!a.collapsed&&c&&e?(this.editor.body.empty(),a.setStart(this.editor.body[0],0),a.collapse(!0),this.range(a)):a.deleteContents();return a};b.prototype.breakBlockEl=function(a,c){null==c&&(c=this.range());a=d(a);if(!c.collapsed)return a;c.setStartBefore(a.get(0));return c.collapsed?a:a.before(c.extractContents())};
b.prototype.save=function(a){null==a&&(a=this.range());if(!this._selectionSaved){var c=a.cloneRange();c.collapse(!1);var e=d("<span/>").addClass("simditor-caret-start");var b=d("<span/>").addClass("simditor-caret-end");c.insertNode(b[0]);a.insertNode(e[0]);this.clear();return this._selectionSaved=!0}};b.prototype.restore=function(){if(!this._selectionSaved)return!1;var a=this.editor.body.find(".simditor-caret-start");var c=this.editor.body.find(".simditor-caret-end");if(a.length&&c.length){var e=
a.parent();var b=e.contents().index(a);var f=c.parent();var d=f.contents().index(c);e[0]===f[0]&&--d;var h=document.createRange();h.setStart(e.get(0),b);h.setEnd(f.get(0),d);a.remove();c.remove();this.range(h)}else a.remove(),c.remove();this._selectionSaved=!1;return h};return b}(m);var D=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="Formatter";b.prototype.opts={allowedTags:[],allowedAttributes:{},allowedStyles:{}};b.prototype._init=function(){this.editor=
this._module;this._allowedTags=d.merge("br span a img b strong i strike u font p ul ol li blockquote pre code h1 h2 h3 h4 hr".split(" "),this.opts.allowedTags);this._allowedAttributes=d.extend({img:["src","alt","width","height","data-non-image"],a:["href","target"],font:["color"],code:["class"]},this.opts.allowedAttributes);this._allowedStyles=d.extend({span:["color","font-size"],b:["color"],i:["color"],strong:["color"],strike:["color"],u:["color"],p:["margin-left","text-align"],h1:["margin-left",
"text-align"],h2:["margin-left","text-align"],h3:["margin-left","text-align"],h4:["margin-left","text-align"]},this.opts.allowedStyles);return this.editor.body.on("click","a",function(a){return!1})};b.prototype.decorate=function(a){null==a&&(a=this.editor.body);this.editor.trigger("decorate",[a]);return a};b.prototype.undecorate=function(a){null==a&&(a=this.editor.body.clone());this.editor.trigger("undecorate",[a]);return a};b.prototype.autolink=function(a){var c,e;null==a&&(a=this.editor.body);var b=
[];var f=function(c){return c.contents().each(function(c,e){var g;c=d(e);if(!c.is("a")&&!c.closest("a, pre",a).length){if(!c.is("iframe")&&c.contents().length)return f(c);if((g=c.text())&&/https?:\/\/|www\./ig.test(g))return b.push(c)}})};f(a);var k=/(https?:\/\/|www\.)[\w\-\.\?&=\/#%:,@!\+]+/ig;var h=0;for(e=b.length;h<e;h++){var p=b[h];var l=p.text();var z=[];var m=null;for(c=0;null!==(m=k.exec(l));){c=l.substring(c,m.index);z.push(document.createTextNode(c));c=k.lastIndex;var n=/^(http(s)?:\/\/|\/)/.test(m[0])?
m[0]:"http://"+m[0];m=d('<a href="'+n+'" rel="nofollow"></a>').text(m[0]);z.push(m[0])}z.push(document.createTextNode(l.substring(c)));p.replaceWith(d(z))}return a};b.prototype.format=function(a){var c,e;null==a&&(a=this.editor.body);if(a.is(":empty"))return a.append("<p>"+this.editor.util.phBr+"</p>"),a;var b=a.contents();var f=0;for(e=b.length;f<e;f++){var k=b[f];this.cleanNode(k,!0)}var h=a.contents();e=0;for(k=h.length;e<k;e++)if(b=h[e],f=d(b),f.is("br"))"undefined"!==typeof c&&null!==c&&(c=null),
f.remove();else if(this.editor.util.isBlockNode(b))f.is("li")?(c&&c.is("ul, ol")||(c=d("<ul/>").insertBefore(b)),c.append(b)):c=null;else{if(!c||c.is("ul, ol"))c=d("<p/>").insertBefore(b);c.append(b);this.editor.util.isEmptyNode(c)&&c.append(this.editor.util.phBr)}return a};b.prototype.cleanNode=function(a,c){var e,b,f,k;var h=d(a);if(0<h.length)if(3===h[0].nodeType)(a=h.text().replace(/(\r\n|\n|\r)/gm,""))?(a=document.createTextNode(a),h.replaceWith(a)):h.remove();else{a=h.is("iframe")?null:h.contents();
var p=this.editor.util.isDecoratedNode(h);if(h.is(this._allowedTags.join(","))||p){if(h.is("a")&&0<(b=h.find("img")).length&&(h.replaceWith(b),h=b,a=null),h.is("td")&&0<(e=h.find(this.editor.util.blockNodes.join(","))).length&&(e.each(function(a){return function(a,c){return d(c).contents().unwrap()}}(this)),a=h.contents()),h.is("img")&&h.hasClass("uploading")&&h.remove(),!p){e=this._allowedAttributes[h[0].tagName.toLowerCase()];var l=d.makeArray(h[0].attributes);p=0;for(k=l.length;p<k;p++)b=l[p],
"style"!==b.name&&(null!=e&&(f=b.name,0<=y.call(e,f))||h.removeAttr(b.name));this._cleanNodeStyles(h);h.is("span")&&(0===h[0].attributes.length&&h.contents().first().unwrap(),2===h[0].style.length&&"rgb(51, 51, 51)"===h[0].style.color&&"16px"===h[0].style.fontSize&&h.contents().unwrap())}}else if(1!==h[0].nodeType||h.is(":empty"))h.remove(),a=null;else if(h.is("div, article, dl, header, footer, tr"))h.append("<br/>"),a.first().unwrap();else if(h.is("table")){var m=d("<p/>");h.find("tr").each(function(a,
c){return m.append(d(c).text()+"<br/>")});h.replaceWith(m);a=null}else h.is("thead, tfoot")?(h.remove(),a=null):h.is("th")?(f=d("<td/>").append(h.contents()),h.replaceWith(f)):a.first().unwrap();if(c&&null!=a&&!h.is("pre"))for(h=0,c=a.length;h<c;h++)f=a[h],this.cleanNode(f,!0);return null}};b.prototype._cleanNodeStyles=function(a){var c,e,b;if(c=a.attr("style")){a.removeAttr("style");var f=this._allowedStyles[a[0].tagName.toLowerCase()];if(!(f&&0<f.length))return a;var k={};var h=c.split(";");c=0;
for(e=h.length;c<e;c++){var p=h[c];p=d.trim(p);p=p.split(":");2===p.length&&!("font-size"===p[0]&&0<p[1].indexOf("px")&&12>parseInt(p[1],10))&&(b=p[0],0<=y.call(f,b))&&(k[d.trim(p[0])]=d.trim(p[1]))}0<Object.keys(k).length&&a.css(k);return a}};b.prototype.clearHtml=function(a,c){null==c&&(c=!0);var e=d("<div/>").append(a).contents();var b="";e.each(function(a){return function(g,f){var h;if(3===f.nodeType)return b+=f.nodeValue;if(1===f.nodeType&&(f=d(f),(h=f.is("iframe")?null:f.contents())&&0<h.length&&
(b+=a.clearHtml(h)),c&&g<e.length-1&&f.is("br, p, div, li,tr, pre, address, artticle, aside, dl, figcaption, footer, h1, h2,h3, h4, header")))return b+="\n"}}(this));return b};b.prototype.beautify=function(a){var c=function(a){return!!(a.is("p")&&!a.text()&&1>a.children(":not(br)").length)};return a.each(function(a,b){a=d(b);(a.is(':not(img, br, col, td, hr, [class^="simditor-"]):empty')||c(a))&&a.remove();return a.find(':not(img, br, col, td, hr, [class^="simditor-"]):empty').remove()})};return b}(m);
var E=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="InputManager";b.prototype._modifierKeys=[16,17,18,91,93,224];b.prototype._arrowKeys=[37,38,39,40];b.prototype._init=function(){this.editor=this._module;this.throttledValueChanged=this.editor.util.throttle(function(a){return function(c){return setTimeout(function(){return a.editor.trigger("valuechanged",c)},10)}}(this),300);this.throttledSelectionChanged=this.editor.util.throttle(function(a){return function(){return a.editor.trigger("selectionchanged")}}(this),
50);d(document).on("selectionchange.simditor"+this.editor.id,function(a){return function(c){if(a.focused&&!a.editor.clipboard.pasting){var e=function(){a._selectionTimer&&(clearTimeout(a._selectionTimer),a._selectionTimer=null);return 0<a.editor.selection._selection.rangeCount?a.throttledSelectionChanged():a._selectionTimer=setTimeout(function(){a._selectionTimer=null;if(a.focused)return e()},10)};return e()}}}(this));this.editor.on("valuechanged",function(a){return function(){a.lastCaretPosition=
null;var c=a.editor.body.children().filter(function(c,e){return a.editor.util.isBlockNode(e)});a.focused&&0===c.length&&(a.editor.selection.save(),a.editor.formatter.format(),a.editor.selection.restore());a.editor.body.find("hr, pre, .simditor-table").each(function(c,e){c=d(e);if(c.parent().is("blockquote")||c.parent()[0]===a.editor.body[0])if(e=!1,0===c.next().length&&(d("<p/>").append(a.editor.util.phBr).insertAfter(c),e=!0),0===c.prev().length&&(d("<p/>").append(a.editor.util.phBr).insertBefore(c),
e=!0),e)return a.throttledValueChanged()});a.editor.body.find("pre:empty").append(a.editor.util.phBr);if(!a.editor.util.support.onselectionchange&&a.focused)return a.throttledSelectionChanged()}}(this));this.editor.body.on("keydown",d.proxy(this._onKeyDown,this)).on("keypress",d.proxy(this._onKeyPress,this)).on("keyup",d.proxy(this._onKeyUp,this)).on("mouseup",d.proxy(this._onMouseUp,this)).on("focus",d.proxy(this._onFocus,this)).on("blur",d.proxy(this._onBlur,this)).on("drop",d.proxy(this._onDrop,
this)).on("input",d.proxy(this._onInput,this));if(this.editor.util.browser.firefox){this.editor.hotkeys.add("cmd+left",function(a){return function(c){c.preventDefault();a.editor.selection._selection.modify("move","backward","lineboundary");return!1}}(this));this.editor.hotkeys.add("cmd+right",function(a){return function(c){c.preventDefault();a.editor.selection._selection.modify("move","forward","lineboundary");return!1}}(this));var a=this.editor.util.os.mac?"cmd+a":"ctrl+a";this.editor.hotkeys.add(a,
function(a){return function(c){var e=a.editor.body.children();if(0<e.length){c=e.first().get(0);e=e.last().get(0);var b=document.createRange();b.setStart(c,0);b.setEnd(e,a.editor.util.getNodeLength(e));a.editor.selection.range(b);return!1}}}(this))}return this.editor.hotkeys.add(this.editor.util.os.mac?"cmd+enter":"ctrl+enter",function(a){return function(c){a.editor.el.closest("form").find("button:submit").click();return!1}}(this))};b.prototype._onFocus=function(a){if(!this.editor.clipboard.pasting)return this.editor.el.addClass("focus").removeClass("error"),
this.focused=!0,setTimeout(function(a){return function(){var c=a.editor.selection._selection.getRangeAt(0);if(c.startContainer===a.editor.body[0])if(a.lastCaretPosition)a.editor.undoManager.caretPosition(a.lastCaretPosition);else{var b=a.editor.body.children().first();c=document.createRange();a.editor.selection.setRangeAtStartOf(b,c)}a.lastCaretPosition=null;a.editor.triggerHandler("focus");if(!a.editor.util.support.onselectionchange)return a.throttledSelectionChanged()}}(this),0)};b.prototype._onBlur=
function(a){var c;if(!this.editor.clipboard.pasting)return this.editor.el.removeClass("focus"),this.editor.sync(),this.focused=!1,this.lastCaretPosition=null!=(c=this.editor.undoManager.currentState())?c.caret:void 0,this.editor.triggerHandler("blur")};b.prototype._onMouseUp=function(a){if(!this.editor.util.support.onselectionchange)return this.throttledSelectionChanged()};b.prototype._onKeyDown=function(a){var c,e;if(!1===this.editor.triggerHandler(a))return!1;if(!this.editor.hotkeys.respondTo(a)){if(this.editor.keystroke.respondTo(a))return this.throttledValueChanged(),
!1;if(!((c=a.which,0<=y.call(this._modifierKeys,c))||(e=a.which,0<=y.call(this._arrowKeys,e))||this.editor.util.metaKey(a)&&86===a.which))return this.editor.util.support.oninput||this.throttledValueChanged(["typing"]),null}};b.prototype._onKeyPress=function(a){if(!1===this.editor.triggerHandler(a))return!1};b.prototype._onKeyUp=function(a){var c;if(!1===this.editor.triggerHandler(a))return!1;!this.editor.util.support.onselectionchange&&(c=a.which,0<=y.call(this._arrowKeys,c))?this.throttledValueChanged():
8!==a.which&&46!==a.which||!this.editor.util.isEmptyNode(this.editor.body)||(this.editor.body.empty(),a=d("<p/>").append(this.editor.util.phBr).appendTo(this.editor.body),this.editor.selection.setRangeAtStartOf(a))};b.prototype._onDrop=function(a){return!1===this.editor.triggerHandler(a)?!1:this.throttledValueChanged()};b.prototype._onInput=function(a){return this.throttledValueChanged(["oninput"])};return b}(m);var F=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,
l);b.pluginName="Keystroke";b.prototype._init=function(){this.editor=this._module;this._keystrokeHandlers={};return this._initKeystrokeHandlers()};b.prototype.add=function(a,c,e){a=a.toLowerCase();a=this.editor.hotkeys.constructor.aliases[a]||a;this._keystrokeHandlers[a]||(this._keystrokeHandlers[a]={});return this._keystrokeHandlers[a][c]=e};b.prototype.respondTo=function(a){var c,e,b,f;if((e=null!=(b=this.editor.hotkeys.constructor.keyNameMap[a.which])?b.toLowerCase():void 0)&&e in this._keystrokeHandlers&&
((f="function"===typeof(c=this._keystrokeHandlers[e])["*"]?c["*"](a):void 0)||this.editor.selection.startNodes().each(function(c){return function(b,g){var h;if(g.nodeType===Node.ELEMENT_NODE&&(b=null!=(h=c._keystrokeHandlers[e])?h[g.tagName.toLowerCase()]:void 0,f="function"===typeof b?b(a,d(g)):void 0,!0===f||!1===f))return!1}}(this)),f))return!0};b.prototype._initKeystrokeHandlers=function(){this.editor.util.browser.safari&&this.add("enter","*",function(a){return function(c){if(c.shiftKey&&(c=a.editor.selection.blockNodes().last(),
!c.is("pre"))){var b=d("<br/>");a.editor.selection.rangeAtEndOf(c)?(a.editor.selection.insertNode(b),a.editor.selection.insertNode(d("<br/>")),a.editor.selection.setRangeBefore(b)):a.editor.selection.insertNode(b);return!0}}}(this));if(this.editor.util.browser.webkit||this.editor.util.browser.msie){var a=function(a){return function(c,b){if(a.editor.selection.rangeAtEndOf(b))return c=d("<p/>").append(a.editor.util.phBr).insertAfter(b),a.editor.selection.setRangeAtStartOf(c),!0}}(this);this.add("enter",
"h1",a);this.add("enter","h2",a);this.add("enter","h3",a);this.add("enter","h4",a);this.add("enter","h5",a);this.add("enter","h6",a)}this.add("backspace","*",function(a){return function(c){var b=a.editor.selection.rootNodes().first();var e=b.prev();if(e.is("hr")&&a.editor.selection.rangeAtStartOf(b))return a.editor.selection.save(),e.remove(),a.editor.selection.restore(),!0;var d=a.editor.selection.blockNodes().last();d.is(".simditor-resize-handle")&&b.is(".simditor-table")&&(c.preventDefault(),b.remove(),
a.editor.selection.setRangeAtEndOf(e));e.is(".simditor-table")&&!d.is("table")&&a.editor.util.isEmptyNode(d)&&(c.preventDefault(),d.remove(),a.editor.selection.setRangeAtEndOf(e));if(a.editor.util.browser.webkit&&a.editor.selection.rangeAtStartOf(d))return a.editor.selection.save(),a.editor.formatter.cleanNode(d,!0),a.editor.selection.restore(),null}}(this));this.add("enter","div",function(a){return function(c,b){if(b.is(".simditor-table")){var e=a.editor.selection.blockNodes().last();if(e.is(".simditor-resize-handle"))return c.preventDefault(),
c=d("<p/>").append(a.editor.util.phBr).insertAfter(b),a.editor.selection.setRangeAtStartOf(c)}}}(this));this.add("enter","li",function(a){return function(c,b){c=b.clone();c.find("ul, ol").remove();if(a.editor.util.isEmptyNode(c)&&b.is(a.editor.selection.blockNodes().last())){c=b.parent();if(0<b.next("li").length){if(!a.editor.util.isEmptyNode(b))return;if(0<c.parent("li").length){var e=d("<li/>").append(a.editor.util.phBr).insertAfter(c.parent("li"));var g=d("<"+c[0].tagName+"/>").append(b.nextAll("li"));
e.append(g)}else e=d("<p/>").append(a.editor.util.phBr).insertAfter(c),g=d("<"+c[0].tagName+"/>").append(b.nextAll("li")),e.after(g)}else 0<c.parent("li").length?(e=d("<li/>").insertAfter(c.parent("li")),0<b.contents().length?e.append(b.contents()):e.append(a.editor.util.phBr)):(e=d("<p/>").append(a.editor.util.phBr).insertAfter(c),0<b.children("ul, ol").length&&e.after(b.children("ul, ol")));b.prev("li").length?b.remove():b.prev("ul").length||b.prev("ol").length?b.remove():c.remove();a.editor.selection.setRangeAtStartOf(e);
return!0}}}(this));this.add("enter","pre",function(a){return function(c,b){c.preventDefault();if(c.shiftKey)return b=d("<p/>").append(a.editor.util.phBr).insertAfter(b),a.editor.selection.setRangeAtStartOf(b),!0;c=a.editor.selection.range();c.deleteContents();!a.editor.util.browser.msie&&a.editor.selection.rangeAtEndOf(b)?(b=document.createTextNode("\n\n"),c.insertNode(b),c.setEnd(b,1)):(b=document.createTextNode("\n"),c.insertNode(b),c.setStartAfter(b));c.collapse(!1);a.editor.selection.range(c);
return!0}}(this));this.add("enter","blockquote",function(a){return function(c,b){c=a.editor.selection.blockNodes().last();if(c.is("p")&&!c.next().length&&a.editor.util.isEmptyNode(c))return b.after(c),b=document.createRange(),a.editor.selection.setRangeAtStartOf(c,b),!0}}(this));this.add("backspace","li",function(a){return function(c,b){c=b.children("ul, ol");var e=b.prev("li");if(!(0<c.length&&0<e.length))return!1;var g="";var h=null;b.contents().each(function(a,c){if(1===c.nodeType&&/UL|OL/.test(c.nodeName))return!1;
if(1!==c.nodeType||!/BR/.test(c.nodeName))return 3===c.nodeType&&c.nodeValue?g+=c.nodeValue:1===c.nodeType&&(g+=d(c).text()),h=d(c)});var p=a.editor.util.browser.firefox&&!h.next("br").length;if(h&&1===g.length&&p)return b=d(a.editor.util.phBr).insertAfter(h),h.remove(),a.editor.selection.setRangeBefore(b),!0;if(0<g.length)return!1;var l=document.createRange();p=e.children("ul, ol");0<p.length?(e=d("<li/>").append(a.editor.util.phBr).appendTo(p),p.append(c.children("li")),b.remove(),a.editor.selection.setRangeAtEndOf(e,
l)):(a.editor.selection.setRangeAtEndOf(e,l),e.append(c),b.remove(),a.editor.selection.range(l));return!0}}(this));this.add("backspace","pre",function(a){return function(c,b){if(a.editor.selection.rangeAtStartOf(b))return c=b.html().replace("\n","<br/>")||a.editor.util.phBr,c=d("<p/>").append(c).insertAfter(b),b.remove(),b=document.createRange(),a.editor.selection.setRangeAtStartOf(c,b),!0}}(this));return this.add("backspace","blockquote",function(a){return function(c,b){if(a.editor.selection.rangeAtStartOf(b))return c=
b.children().first().unwrap(),b=document.createRange(),a.editor.selection.setRangeAtStartOf(c,b),!0}}(this))};return b}(m);var G=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="UndoManager";b.prototype._index=-1;b.prototype._capacity=20;b.prototype._startPosition=null;b.prototype._endPosition=null;b.prototype._init=function(){this.editor=this._module;this._stack=[];if(this.editor.util.os.mac){var a="cmd+z";var c="shift+cmd+z"}else this.editor.util.os.win?
(a="ctrl+z",c="ctrl+y"):(a="ctrl+z",c="shift+ctrl+z");this.editor.hotkeys.add(a,function(a){return function(c){c.preventDefault();a.undo();return!1}}(this));this.editor.hotkeys.add(c,function(a){return function(c){c.preventDefault();a.redo();return!1}}(this));this.throttledPushState=this.editor.util.throttle(function(a){return function(){return a._pushUndoState()}}(this),2E3);this.editor.on("valuechanged",function(a){return function(c,b){if("undo"!==b&&"redo"!==b)return a.throttledPushState()}}(this));
this.editor.on("selectionchanged",function(a){return function(c){a.resetCaretPosition();return a.update()}}(this));this.editor.on("focus",function(a){return function(c){if(0===a._stack.length)return a._pushUndoState()}}(this));return this.editor.on("blur",function(a){return function(c){return a.resetCaretPosition()}}(this))};b.prototype.resetCaretPosition=function(){return this._endPosition=this._startPosition=null};b.prototype.startPosition=function(){this.editor.selection._range&&(this._startPosition||
(this._startPosition=this._getPosition("start")));return this._startPosition};b.prototype.endPosition=function(){this.editor.selection._range&&(this._endPosition||(this._endPosition=function(a){return function(){return a.editor.selection.range().collapsed?a._startPosition:a._getPosition("end")}}(this)()));return this._endPosition};b.prototype._pushUndoState=function(){if(!1!==this.editor.triggerHandler("pushundostate")&&this.caretPosition().start&&(this._index+=1,this._stack.length=this._index,this._stack.push({html:this.editor.body.html(),
caret:this.caretPosition()}),this._stack.length>this._capacity))return this._stack.shift(),--this._index};b.prototype.currentState=function(){return this._stack.length&&-1<this._index?this._stack[this._index]:null};b.prototype.undo=function(){if(!(1>this._index||2>this._stack.length)){this.editor.hidePopover();--this._index;var a=this._stack[this._index];this.editor.body.get(0).innerHTML=a.html;this.caretPosition(a.caret);this.editor.body.find(".selected").removeClass("selected");this.editor.sync();
return this.editor.trigger("valuechanged",["undo"])}};b.prototype.redo=function(){if(!(0>this._index||this._stack.length<this._index+2)){this.editor.hidePopover();this._index+=1;var a=this._stack[this._index];this.editor.body.get(0).innerHTML=a.html;this.caretPosition(a.caret);this.editor.body.find(".selected").removeClass("selected");this.editor.sync();return this.editor.trigger("valuechanged",["redo"])}};b.prototype.update=function(){var a;if(a=this.currentState())return a.html=this.editor.body.html(),
a.caret=this.caretPosition()};b.prototype._getNodeOffset=function(a,c){var b=d.isNumeric(c)?d(a):d(a).parent();var g=0;var f=!1;b.contents().each(function(b,e){if(a===e||c===b&&0===b)return!1;e.nodeType===Node.TEXT_NODE?!f&&0<e.nodeValue.length&&(g+=1,f=!0):(g+=1,f=!1);return c-1===b?!1:null});return g};b.prototype._getPosition=function(a){var c;null==a&&(a="start");var b=this.editor.selection.range()[a+"Offset"];var g=this.editor.selection[a+"Nodes"]();a=g.first()[0];if(a.nodeType===Node.TEXT_NODE){for(c=
a.previousSibling;c&&c.nodeType===Node.TEXT_NODE;)a=c,b+=this.editor.util.getNodeLength(c),c=c.previousSibling;g=g.get();g[0]=a;g=d(g)}else b=this._getNodeOffset(a,b);var f=[b];g.each(function(a){return function(c,b){return f.unshift(a._getNodeOffset(b))}}(this));return f};b.prototype._getNodeByPosition=function(a){var c,b;var g=this.editor.body[0];var f=a.slice(0,a.length-1);var k=c=0;for(b=f.length;c<b;k=++c){var h=f[k];var p=g.childNodes;if(h>p.length-1)if(k===a.length-2&&d(g).is("pre:empty"))p=
document.createTextNode(""),g.appendChild(p),p=g.childNodes;else{g=null;break}g=p[h]}return g};b.prototype.caretPosition=function(a){if(a){if(a.start){var c=this._getNodeByPosition(a.start);var b=a.start[a.start.length-1];if(a.collapsed){var d=c;a=b}else d=this._getNodeByPosition(a.end),a=a.start[a.start.length-1];if(c&&d){var f=document.createRange();f.setStart(c,b);f.setEnd(d,a);return this.editor.selection.range(f)}"undefined"!==typeof console&&null!==console&&"function"===typeof console.warn&&
console.warn("simditor: invalid caret state")}}else return f=this.editor.selection.range(),a=this.editor.inputManager.focused&&null!=f?{start:this.startPosition(),end:this.endPosition(),collapsed:f.collapsed}:{}};return b}(m);var H=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="Util";b.prototype._init=function(){this.editor=this._module;if(this.browser.msie&&11>this.browser.version)return this.phBr=""};b.prototype.phBr="<br/>";b.prototype.os=function(){var a=
{};/Mac/.test(navigator.appVersion)?a.mac=!0:/Linux/.test(navigator.appVersion)?a.linux=!0:/Win/.test(navigator.appVersion)?a.win=!0:/X11/.test(navigator.appVersion)&&(a.unix=!0);/Mobi/.test(navigator.appVersion)&&(a.mobile=!0);return a}();b.prototype.browser=function(){var a,c,b,d,f;var k=navigator.userAgent;var h=/(msie|trident)/i.test(k);var p=/chrome|crios/i.test(k);var l=/safari/i.test(k)&&!p;var m=/firefox/i.test(k);var n=/edge/i.test(k);return h?{msie:!0,version:1*(null!=(a=k.match(/(msie |rv:)(\d+(\.\d+)?)/i))?
a[2]:NaN)}:n?{edge:!0,webkit:!0,version:1*(null!=(c=k.match(/edge\/(\d+(\.\d+)?)/i))?c[1]:NaN)}:p?{webkit:!0,chrome:!0,version:1*(null!=(b=k.match(/(?:chrome|crios)\/(\d+(\.\d+)?)/i))?b[1]:NaN)}:l?{webkit:!0,safari:!0,version:1*(null!=(d=k.match(/version\/(\d+(\.\d+)?)/i))?d[1]:NaN)}:m?{mozilla:!0,firefox:!0,version:1*(null!=(f=k.match(/firefox\/(\d+(\.\d+)?)/i))?f[1]:NaN)}:{}}();b.prototype.support=function(){a:{var a=document.onselectionchange;if(void 0!==a)try{document.onselectionchange=0;var c=
null===document.onselectionchange;break a}catch(e){}finally{document.onselectionchange=a}c=!1}return{onselectionchange:c,oninput:!/(msie|trident)/i.test(navigator.userAgent)}}();b.prototype.reflow=function(a){null==a&&(a=document);return d(a)[0].offsetHeight};b.prototype.metaKey=function(a){return/Mac/.test(navigator.userAgent)?a.metaKey:a.ctrlKey};b.prototype.isEmptyNode=function(a){a=d(a);return a.is(":empty")||!a.text()&&!a.find(":not(br, span, div)").length};b.prototype.isDecoratedNode=function(a){return d(a).is('[class^="simditor-"]')};
b.prototype.blockNodes="div p ul ol li blockquote hr pre h1 h2 h3 h4 h5 table".split(" ");b.prototype.isBlockNode=function(a){return(a=d(a)[0])&&3!==a.nodeType?(new RegExp("^("+this.blockNodes.join("|")+")$")).test(a.nodeName.toLowerCase()):!1};b.prototype.getNodeLength=function(a){a=d(a)[0];switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}};b.prototype.dataURLtoBlob=function(a){var c,b,d,f;if(c=window.Blob)try{c=!!new Blob}catch(B){c=!1}if(c=
(b=c)&&window.Uint8Array)try{c=100===(new Blob([new Uint8Array(100)])).size}catch(B){c=!1}var k=c;var h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(!((b||h)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return!1;var p=0<=a.split(",")[0].indexOf("base64")?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]);c=new ArrayBuffer(p.length);var l=new Uint8Array(c);var m=d=0;for(f=p.length;0<=f?d<=f:d>=f;m=0<=f?++d:--d)l[m]=p.charCodeAt(m);a=a.split(",")[0].split(":")[1].split(";")[0];
if(b)return new Blob([k?l:c],{type:a});b=new h;b.append(c);return b.getBlob(a)};b.prototype.throttle=function(a,c){var b,d,f;var k=d=0;var h=b=f=null;var p=function(){k=0;d=+new Date;f=a.apply(h,b);return b=h=null};var l=function(){h=this;b=arguments;var a=new Date-d;k||(a>=c?p():k=setTimeout(p,c-a));return f};l.clear=function(){if(k)return clearTimeout(k),p()};return l};b.prototype.formatHTML=function(a){var c,b,g;var f=/<(\/?)(.+?)(\/?)>/g;var k="";var h=0;var p=null;for(b=function(a,c){return Array(c+
1).join(a)};null!==(c=f.exec(a));){c.isBlockNode=-1<d.inArray(c[2],this.blockNodes);c.isStartTag="/"!==c[1]&&"/"!==c[3];c.isEndTag="/"===c[1]||"/"===c[3];var l=p?p.index+p[0].length:0;0<(g=a.substring(l,c.index)).length&&d.trim(g)&&(k+=g);c.isBlockNode&&c.isEndTag&&!c.isStartTag&&--h;c.isBlockNode&&c.isStartTag&&(p&&p.isBlockNode&&p.isEndTag||(k+="\n"),k+=b("  ",h));k+=c[0];c.isBlockNode&&c.isEndTag&&(k+="\n");c.isBlockNode&&c.isStartTag&&(h+=1);p=c}return d.trim(k)};return b}(m);var I=function(l){function b(){return b.__super__.constructor.apply(this,
arguments)}n(b,l);b.pluginName="Toolbar";b.prototype.opts={toolbar:!0,toolbarFloat:!0,toolbarHidden:!1,toolbarFloatOffset:0};b.prototype._tpl={wrapper:'<div class="simditor-toolbar"><ul></ul></div>',separator:'<li><span class="separator"></span></li>'};b.prototype._init=function(){this.editor=this._module;if(this.opts.toolbar){d.isArray(this.opts.toolbar)||(this.opts.toolbar="bold italic underline strikethrough | ol ul blockquote code | link image | indent outdent".split(" "));this._render();this.list.on("click",
function(a){return!1});this.wrapper.on("mousedown",function(a){return function(c){return a.list.find(".menu-on").removeClass(".menu-on")}}(this));d(document).on("mousedown.simditor"+this.editor.id,function(a){return function(c){return a.list.find(".menu-on").removeClass(".menu-on")}}(this));if(!this.opts.toolbarHidden&&this.opts.toolbarFloat){this.wrapper.css("top",this.opts.toolbarFloatOffset);var a=0;var c=function(c){return function(){c.wrapper.css("position","static");c.wrapper.width("auto");
c.editor.util.reflow(c.wrapper);c.wrapper.width(c.wrapper.outerWidth());c.wrapper.css("left",c.editor.util.os.mobile?c.wrapper.position().left:c.wrapper.offset().left);c.wrapper.css("position","");a=c.wrapper.outerHeight();c.editor.placeholderEl.css("top",a);return!0}}(this);var b=null;d(window).on("resize.simditor-"+this.editor.id,function(a){return b=c()});d(window).on("scroll.simditor-"+this.editor.id,function(e){return function(f){if(e.wrapper.is(":visible")){var g=e.editor.wrapper.offset().top;
f=g+e.editor.wrapper.outerHeight()-80;var h=d(document).scrollTop()+e.opts.toolbarFloatOffset;if(h<=g||h>=f){if(e.editor.wrapper.removeClass("toolbar-floating").css("padding-top",""),e.editor.util.os.mobile)return e.wrapper.css("top",e.opts.toolbarFloatOffset)}else if(b||(b=c()),e.editor.wrapper.addClass("toolbar-floating").css("padding-top",a),e.editor.util.os.mobile)return e.wrapper.css("top",h-g+e.opts.toolbarFloatOffset)}}}(this))}this.editor.on("destroy",function(a){return function(){return a.buttons.length=
0}}(this));return d(document).on("mousedown.simditor-"+this.editor.id,function(a){return function(c){return a.list.find("li.menu-on").removeClass("menu-on")}}(this))}};b.prototype._render=function(){var a;this.buttons=[];this.wrapper=d(this._tpl.wrapper).prependTo(this.editor.wrapper);this.list=this.wrapper.find("ul");var c=this.opts.toolbar;var b=0;for(a=c.length;b<a;b++){var g=c[b];if("|"===g)d(this._tpl.separator).appendTo(this.list);else if(this.constructor.buttons[g])this.buttons.push(new this.constructor.buttons[g]({editor:this.editor}));
else throw Error("simditor: invalid toolbar button "+g);}if(this.opts.toolbarHidden)return this.wrapper.hide()};b.prototype.findButton=function(a){a=this.list.find(".toolbar-item-"+a).data("button");return null!=a?a:null};b.addButton=function(a){return this.buttons[a.prototype.name]=a};b.buttons={};return b}(m);var J=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="Indentation";b.prototype.opts={tabIndent:!0};b.prototype._init=function(){this.editor=
this._module;return this.editor.keystroke.add("tab","*",function(a){return function(c){var b=a.editor.toolbar.findButton("code");if(a.opts.tabIndent||b&&b.active)return a.indent(c.shiftKey)}}(this))};b.prototype.indent=function(a){this.editor.selection.startNodes();this.editor.selection.endNodes();var c=this.editor.selection.blockNodes();var b=[];c=c.each(function(a,c){var e,f;a=!0;var g=e=0;for(f=b.length;e<f;g=++e){var k=b[g];if(d.contains(c,k)){a=!1;break}else if(d.contains(k,c)){b.splice(g,1,
c);a=!1;break}}if(a)return b.push(c)});c=d(b);var g=!1;c.each(function(c){return function(b,e){if(b=a?c.outdentBlock(e):c.indentBlock(e))return g=b}}(this));return g};b.prototype.indentBlock=function(a){a=d(a);if(a.length){if(a.is("pre")){var c=this.editor.selection.containerNode();if(!c.is(a)&&!c.closest("pre").is(a))return;this.indentText(this.editor.selection.range())}else if(a.is("li")){var b=a.prev("li");if(1>b.length)return;this.editor.selection.save();var g=a.parent()[0].tagName;c=b.children("ul, ol");
0<c.length?c.append(a):d("<"+g+"/>").append(a).appendTo(b);this.editor.selection.restore()}else if(a.is("p, h1, h2, h3, h4"))c=parseInt(a.css("margin-left"))||0,c=(Math.round(c/this.opts.indentWidth)+1)*this.opts.indentWidth,a.css("margin-left",c);else if(a.is("table")||a.is(".simditor-table")){a=this.editor.selection.containerNode().closest("td, th");c=a.next("td, th");0<c.length||(b=a.parent("tr"),c=b.next("tr"),1>c.length&&b.parent().is("thead")&&(c=b.parent("thead").next("tbody").find("tr:first")),
c=c.find("td:first, th:first"));if(!(0<a.length&&0<c.length))return;this.editor.selection.setRangeAtEndOf(c)}else return!1;return!0}};b.prototype.indentText=function(a){var c=a.toString().replace(/^(?=.+)/mg,"\u00a0\u00a0");var b=document.createTextNode(c||"\u00a0\u00a0");a.deleteContents();a.insertNode(b);return c?(a.selectNode(b),this.editor.selection.range(a)):this.editor.selection.setRangeAfter(b)};b.prototype.outdentBlock=function(a){if((a=d(a))&&0<a.length){if(a.is("pre")){var c=this.editor.selection.containerNode();
if(!c.is(a)&&!c.closest("pre").is(a))return;this.outdentText(b)}else if(a.is("li")){c=a.parent();var b=c.parent("li");this.editor.selection.save();1>b.length?(b=document.createRange(),b.setStartBefore(c[0]),b.setEndBefore(a[0]),c.before(b.extractContents()),d("<p/>").insertBefore(c).after(a.children("ul, ol")).append(a.contents()),a.remove()):(0<a.next("li").length&&d("<"+c[0].tagName+"/>").append(a.nextAll("li")).appendTo(a),a.insertAfter(b),1>c.children("li").length&&c.remove());this.editor.selection.restore()}else if(a.is("p, h1, h2, h3, h4"))b=
parseInt(a.css("margin-left"))||0,b=Math.max(Math.round(b/this.opts.indentWidth)-1,0)*this.opts.indentWidth,a.css("margin-left",0===b?"":b);else if(a.is("table")||a.is(".simditor-table")){a=this.editor.selection.containerNode().closest("td, th");b=a.prev("td, th");0<b.length||(c=a.parent("tr"),b=c.prev("tr"),1>b.length&&c.parent().is("tbody")&&(b=c.parent("tbody").prev("thead").find("tr:first")),b=b.find("td:last, th:last"));if(!(0<a.length&&0<b.length))return;this.editor.selection.setRangeAtEndOf(b)}else return!1;
return!0}};b.prototype.outdentText=function(a){};return b}(m);var K=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.pluginName="Clipboard";b.prototype.opts={pasteImage:!1,cleanPaste:!1};b.prototype._init=function(){this.editor=this._module;this.opts.pasteImage&&"string"!==typeof this.opts.pasteImage&&(this.opts.pasteImage="inline");return this.editor.body.on("paste",function(a){return function(c){if(!a.pasting&&!a._pasteBin){if(!1===a.editor.triggerHandler(c))return!1;
var b=a.editor.selection.deleteRangeContents();a.editor.body.html()?b.collapsed||b.collapse(!0):(a.editor.formatter.format(),a.editor.selection.setRangeAtStartOf(a.editor.body.find("p:first")));if(a._processPasteByClipboardApi(c))return!1;a.editor.inputManager.throttledValueChanged.clear();a.editor.inputManager.throttledSelectionChanged.clear();a.editor.undoManager.throttledPushState.clear();a.editor.selection.reset();a.editor.undoManager.resetCaretPosition();a.pasting=!0;return a._getPasteContent(function(c){a._processPasteContent(c);
a._pasteInBlockEl=null;a._pastePlainText=null;return a.pasting=!1})}}}(this))};b.prototype._processPasteByClipboardApi=function(a){var c;if(!this.editor.util.browser.edge&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items&&0<a.originalEvent.clipboardData.items.length&&(a=a.originalEvent.clipboardData.items[0],/^image\//.test(a.type)&&(a=a.getAsFile(),null!=a&&this.opts.pasteImage&&(a.name||(a.name="Clipboard Image.png"),!1!==this.editor.triggerHandler("pasting",[a]))))){var b={};
b[this.opts.pasteImage]=!0;null!=(c=this.editor.uploader)&&c.upload(a,b);return!0}};b.prototype._getPasteContent=function(a){this._pasteBin=d('<div contenteditable="true" />').addClass("simditor-paste-bin").attr("tabIndex","-1").appendTo(this.editor.el);var c=this.editor.body.html();var b=this.editor.undoManager.caretPosition();this._pasteBin.focus();return setTimeout(function(e){return function(){e.editor.hidePopover();e.editor.body.get(0).innerHTML=c;e.editor.undoManager.caretPosition(b);e.editor.body.focus();
e.editor.selection.reset();e.editor.selection.range();e._pasteInBlockEl=e.editor.selection.blockNodes().last();e._pastePlainText=e.opts.cleanPaste||e._pasteInBlockEl.is("pre, table");if(e._pastePlainText)var f=e.editor.formatter.clearHtml(e._pasteBin.html(),!0);else f=d("<div/>").append(e._pasteBin.contents()),f.find("style").remove(),f.find("table colgroup").remove(),e.editor.formatter.format(f),e.editor.formatter.decorate(f),e.editor.formatter.beautify(f.children()),f=f.contents();e._pasteBin.remove();
e._pasteBin=null;return a(f)}}(this),0)};b.prototype._processPasteContent=function(a){var c;if(!1!==this.editor.triggerHandler("pasting",[a])){var b=this._pasteInBlockEl;if(a){if(this._pastePlainText)if(b.is("table")){var g=a.split("\n");a=g.pop();b=0;for(c=g.length;b<c;b++){var f=g[b];this.editor.selection.insertNode(document.createTextNode(f));this.editor.selection.insertNode(d("<br/>"))}this.editor.selection.insertNode(document.createTextNode(a))}else for(a=d("<div/>").text(a),f=a.contents(),a=
0,c=f.length;a<c;a++)b=f[a],this.editor.selection.insertNode(d(b)[0]);else if(b.is(this.editor.body))for(f=0,c=a.length;f<c;f++)b=a[f],this.editor.selection.insertNode(b);else{if(1>a.length)return;if(1===a.length)if(a.is("p")){a=a.contents();b.is("h1, h2, h3, h4, h5")&&a.length&&a.css("font-size","");if(1===a.length&&a.is("img")){if(/^data:image/.test(a.attr("src"))){if(!this.opts.pasteImage)return;var k=this.editor.util.dataURLtoBlob(a.attr("src"));k.name="Clipboard Image.png";var h={};h[this.opts.pasteImage]=
!0;null!=(c=this.editor.uploader)&&c.upload(k,h);return}if((new RegExp("^blob:"+location.origin+"/")).test(a.attr("src"))){if(!this.opts.pasteImage)return;h={};h[this.opts.pasteImage]=!0;var p=this.editor.util.dataURLtoBlob;var l=this.editor.uploader;var m=new Image;m.onload=function(){var a=document.createElement("canvas");a.width=m.naturalWidth;a.height=m.naturalHeight;a.getContext("2d").drawImage(m,0,0);k=p(a.toDataURL("image/png"));k.name="Clipboard Image.png";null!==l&&l.upload(k,h)};m.src=a.attr("src");
return}if(a.is('img[src^="webkit-fake-url://"]'))return}f=0;for(c=a.length;f<c;f++)b=a[f],this.editor.selection.insertNode(b)}else if(b.is("p")&&this.editor.util.isEmptyNode(b))b.replaceWith(a),this.editor.selection.setRangeAtEndOf(a);else if(a.is("ul, ol"))if(1===a.find("li").length)for(a=d("<div/>").text(a.text()),f=a.contents(),c=0,a=f.length;c<a;c++)b=f[c],this.editor.selection.insertNode(d(b)[0]);else b.is("li")?b.parent().after(a):b.after(a),this.editor.selection.setRangeAtEndOf(a);else b.after(a),
this.editor.selection.setRangeAtEndOf(a);else b.is("li")&&(b=b.parent()),this.editor.selection.rangeAtStartOf(b)?c="before":this.editor.selection.rangeAtEndOf(b)?c="after":(this.editor.selection.breakBlockEl(b),c="before"),b[c](a),this.editor.selection.setRangeAtEndOf(a.last())}return this.editor.inputManager.throttledValueChanged()}}};return b}(m);var q=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.connect(H);b.connect(E);b.connect(C);b.connect(G);b.connect(F);
b.connect(D);b.connect(I);b.connect(J);b.connect(K);b.count=0;b.prototype.opts={textarea:null,placeholder:"",defaultImage:"images/image.png",params:{},upload:!1,indentWidth:40};b.prototype._init=function(){this.textarea=d(this.opts.textarea);this.opts.placeholder=this.opts.placeholder||this.textarea.attr("placeholder");if(!this.textarea.length)throw Error("simditor: param textarea is required.");var a=this.textarea.data("simditor");null!=a&&a.destroy();this.id=++b.count;this._render();if(t){if(this.hotkeys=
t({el:this.body}),this.opts.upload&&u&&(a="object"===typeof this.opts.upload?this.opts.upload:{},this.uploader=u(a)),this.on("initialized",function(a){return function(){if(a.opts.placeholder)a.on("valuechanged",function(){return a._placeholder()});a.setValue(a.textarea.val().trim()||"");if(a.textarea.attr("autofocus"))return a.focus()}}(this)),this.util.browser.mozilla){this.util.reflow();try{return document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",
!1,!1)}catch(c){}}}else throw Error("simditor: simple-hotkeys is required.");};b.prototype._tpl='<div class="simditor">\n  <div class="simditor-wrapper">\n    <div class="simditor-placeholder"></div>\n    <div class="simditor-body" contenteditable="true">\n    </div>\n  </div>\n</div>';b.prototype._render=function(){var a;this.el=d(this._tpl).insertBefore(this.textarea);this.wrapper=this.el.find(".simditor-wrapper");this.body=this.wrapper.find(".simditor-body");this.placeholderEl=this.wrapper.find(".simditor-placeholder").append(this.opts.placeholder);
this.el.data("simditor",this);this.wrapper.append(this.textarea);this.textarea.data("simditor",this).blur();this.body.attr("tabindex",this.textarea.attr("tabindex"));this.util.os.mac?this.el.addClass("simditor-mac"):this.util.os.linux&&this.el.addClass("simditor-linux");this.util.os.mobile&&this.el.addClass("simditor-mobile");if(this.opts.params){var c=this.opts.params;var b=[];for(a in c){var g=c[a];b.push(d("<input/>",{type:"hidden",name:a,value:g}).insertAfter(this.textarea))}return b}};b.prototype._placeholder=
function(){var a=this.body.children();return 0===a.length||1===a.length&&this.util.isEmptyNode(a)&&parseInt(a.css("margin-left")||0)<this.opts.indentWidth?this.placeholderEl.show():this.placeholderEl.hide()};b.prototype.setValue=function(a){this.hidePopover();this.textarea.val(a);this.body.get(0).innerHTML=a;this.formatter.format();this.formatter.decorate();this.util.reflow(this.body);this.inputManager.lastCaretPosition=null;return this.trigger("valuechanged")};b.prototype.getValue=function(){return this.sync()};
b.prototype.sync=function(){var a;var c=this.body.clone();this.formatter.undecorate(c);this.formatter.format(c);this.formatter.autolink(c);var b=c.children();var g=b.last("p");for(a=b.first("p");g.is("p")&&this.util.isEmptyNode(g);)b=g,g=g.prev("p"),b.remove();for(;a.is("p")&&this.util.isEmptyNode(a);)b=a,a=g.next("p"),b.remove();c.find("img.uploading").remove();c=d.trim(c.html());this.textarea.val(c);return c};b.prototype.focus=function(){if(this.body.is(":visible")&&this.body.is("[contenteditable]")){if(this.inputManager.lastCaretPosition)return this.undoManager.caretPosition(this.inputManager.lastCaretPosition),
this.inputManager.lastCaretPosition=null;var a=this.body.children().last();a.is("p")||(a=d("<p/>").append(this.util.phBr).appendTo(this.body));var b=document.createRange();return this.selection.setRangeAtEndOf(a,b)}this.el.find("textarea:visible").focus()};b.prototype.blur=function(){return this.body.is(":visible")&&this.body.is("[contenteditable]")?this.body.blur():this.body.find("textarea:visible").blur()};b.prototype.hidePopover=function(){return this.el.find(".simditor-popover").each(function(a,
b){b=d(b).data("popover");if(b.active)return b.hide()})};b.prototype.destroy=function(){this.triggerHandler("destroy");this.textarea.closest("form").off(".simditor .simditor-"+this.id);this.selection.clear();this.inputManager.focused=!1;this.textarea.insertBefore(this.el).hide().val("").removeData("simditor");this.el.remove();d(document).off(".simditor-"+this.id);d(window).off(".simditor-"+this.id);return this.off()};return b}(m);q.i18n={"zh-CN":{blockquote:"\u5f15\u7528",bold:"\u52a0\u7c97\u6587\u5b57",
code:"\u63d2\u5165\u4ee3\u7801",color:"\u6587\u5b57\u989c\u8272",coloredText:"\u5f69\u8272\u6587\u5b57",hr:"\u5206\u9694\u7ebf",image:"\u63d2\u5165\u56fe\u7247",externalImage:"\u5916\u94fe\u56fe\u7247",uploadImage:"\u4e0a\u4f20\u56fe\u7247",uploadFailed:"\u4e0a\u4f20\u5931\u8d25\u4e86",uploadError:"\u4e0a\u4f20\u51fa\u9519\u4e86",imageUrl:"\u56fe\u7247\u5730\u5740",imageSize:"\u56fe\u7247\u5c3a\u5bf8",imageAlt:"\u56fe\u7247\u63cf\u8ff0",restoreImageSize:"\u8fd8\u539f\u56fe\u7247\u5c3a\u5bf8",uploading:"\u6b63\u5728\u4e0a\u4f20",
indent:"\u5411\u53f3\u7f29\u8fdb",outdent:"\u5411\u5de6\u7f29\u8fdb",italic:"\u659c\u4f53\u6587\u5b57",link:"\u63d2\u5165\u94fe\u63a5",linkText:"\u94fe\u63a5\u6587\u5b57",linkUrl:"\u94fe\u63a5\u5730\u5740",linkTarget:"\u6253\u5f00\u65b9\u5f0f",openLinkInCurrentWindow:"\u5728\u5f53\u524d\u7a97\u53e3\u4e2d\u6253\u5f00",openLinkInNewWindow:"\u5728\u65b0\u7a97\u53e3\u4e2d\u6253\u5f00",removeLink:"\u79fb\u9664\u94fe\u63a5",ol:"\u6709\u5e8f\u5217\u8868",ul:"\u65e0\u5e8f\u5217\u8868",strikethrough:"\u5220\u9664\u7ebf\u6587\u5b57",
table:"\u8868\u683c",deleteRow:"\u5220\u9664\u884c",insertRowAbove:"\u5728\u4e0a\u9762\u63d2\u5165\u884c",insertRowBelow:"\u5728\u4e0b\u9762\u63d2\u5165\u884c",deleteColumn:"\u5220\u9664\u5217",insertColumnLeft:"\u5728\u5de6\u8fb9\u63d2\u5165\u5217",insertColumnRight:"\u5728\u53f3\u8fb9\u63d2\u5165\u5217",deleteTable:"\u5220\u9664\u8868\u683c",title:"\u6807\u9898",normalText:"\u666e\u901a\u6587\u672c",underline:"\u4e0b\u5212\u7ebf\u6587\u5b57",alignment:"\u6c34\u5e73\u5bf9\u9f50",alignCenter:"\u5c45\u4e2d",
alignLeft:"\u5c45\u5de6",alignRight:"\u5c45\u53f3",selectLanguage:"\u9009\u62e9\u7a0b\u5e8f\u8bed\u8a00",fontScale:"\u5b57\u4f53\u5927\u5c0f",fontScaleXLarge:"\u8d85\u5927\u5b57\u4f53",fontScaleLarge:"\u5927\u53f7\u5b57\u4f53",fontScaleNormal:"\u6b63\u5e38\u5927\u5c0f",fontScaleSmall:"\u5c0f\u53f7\u5b57\u4f53",fontScaleXSmall:"\u8d85\u5c0f\u5b57\u4f53"},"en-US":{blockquote:"Block Quote",bold:"Bold",code:"Code",color:"Text Color",coloredText:"Colored Text",hr:"Horizontal Line",image:"Insert Image",
externalImage:"External Image",uploadImage:"Upload Image",uploadFailed:"Upload failed",uploadError:"Error occurs during upload",imageUrl:"Url",imageSize:"Size",imageAlt:"Alt",restoreImageSize:"Restore Origin Size",uploading:"Uploading",indent:"Indent",outdent:"Outdent",italic:"Italic",link:"Insert Link",linkText:"Text",linkUrl:"Url",linkTarget:"Target",openLinkInCurrentWindow:"Open link in current window",openLinkInNewWindow:"Open link in new window",removeLink:"Remove Link",ol:"Ordered List",ul:"Unordered List",
strikethrough:"Strikethrough",table:"Table",deleteRow:"Delete Row",insertRowAbove:"Insert Row Above",insertRowBelow:"Insert Row Below",deleteColumn:"Delete Column",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteTable:"Delete Table",title:"Title",normalText:"Text",underline:"Underline",alignment:"Alignment",alignCenter:"Align Center",alignLeft:"Align Left",alignRight:"Align Right",selectLanguage:"Select Language",fontScale:"Font Size",fontScaleXLarge:"X Large Size",
fontScaleLarge:"Large Size",fontScaleNormal:"Normal Size",fontScaleSmall:"Small Size",fontScaleXSmall:"X Small Size"}};var v=function(l){function b(a){this.editor=a.editor;this.title=this._t(this.name);b.__super__.constructor.call(this,a)}n(b,l);b.prototype._tpl={item:'<li><a tabindex="-1" unselectable="on" class="toolbar-item" href="javascript:;"><span></span></a></li>',menuWrapper:'<div class="toolbar-menu"></div>',menuItem:'<li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;"><span></span></a></li>',
separator:'<li><span class="separator"></span></li>'};b.prototype.name="";b.prototype.icon="";b.prototype.title="";b.prototype.text="";b.prototype.htmlTag="";b.prototype.disableTag="";b.prototype.menu=!1;b.prototype.active=!1;b.prototype.disabled=!1;b.prototype.needFocus=!0;b.prototype.shortcut=null;b.prototype._init=function(){var a;this.render();this.el.on("mousedown",function(a){return function(b){b.preventDefault();b=a.needFocus&&!a.editor.inputManager.focused;if(a.el.hasClass("disabled"))return!1;
b&&a.editor.focus();if(a.menu)return a.wrapper.toggleClass("menu-on").siblings("li").removeClass("menu-on"),a.wrapper.is(".menu-on")&&(b=a.menuWrapper.offset().left+a.menuWrapper.outerWidth()+5-a.editor.wrapper.offset().left-a.editor.wrapper.outerWidth(),0<b&&a.menuWrapper.css({left:"auto",right:0}),a.trigger("menuexpand")),!1;b=a.el.data("param");a.command(b);return!1}}(this));this.wrapper.on("click","a.menu-item",function(a){return function(b){b.preventDefault();b=d(b.currentTarget);a.wrapper.removeClass("menu-on");
var c=a.needFocus&&!a.editor.inputManager.focused;if(b.hasClass("disabled")||c)return!1;a.editor.toolbar.wrapper.removeClass("menu-on");b=b.data("param");a.command(b);return!1}}(this));this.wrapper.on("mousedown","a.menu-item",function(a){return!1});this.editor.on("blur",function(a){return function(){if(a.editor.body.is(":visible")&&a.editor.body.is("[contenteditable]")&&!a.editor.clipboard.pasting)return a.setActive(!1),a.setDisabled(!1)}}(this));null!=this.shortcut&&this.editor.hotkeys.add(this.shortcut,
function(a){return function(b){a.el.mousedown();return!1}}(this));var b=this.htmlTag.split(",");var e=0;for(a=b.length;e<a;e++){var g=b[e];(g=d.trim(g))&&0>d.inArray(g,this.editor.formatter._allowedTags)&&this.editor.formatter._allowedTags.push(g)}return this.editor.on("selectionchanged",function(a){return function(b){if(a.editor.inputManager.focused)return a._status()}}(this))};b.prototype.iconClassOf=function(a){return a?"simditor-icon simditor-icon-"+a:""};b.prototype.setIcon=function(a){return this.el.find("span").removeClass().addClass(this.iconClassOf(a)).text(this.text)};
b.prototype.render=function(){this.wrapper=d(this._tpl.item).appendTo(this.editor.toolbar.list);this.el=this.wrapper.find("a.toolbar-item");this.el.attr("title",this.title).addClass("toolbar-item-"+this.name).data("button",this);this.setIcon(this.icon);if(this.menu)return this.menuWrapper=d(this._tpl.menuWrapper).appendTo(this.wrapper),this.menuWrapper.addClass("toolbar-menu-"+this.name),this.renderMenu()};b.prototype.renderMenu=function(){var a,b;if(d.isArray(this.menu)){this.menuEl=d("<ul/>").appendTo(this.menuWrapper);
var e=this.menu;var g=[];var f=0;for(a=e.length;f<a;f++){var k=e[f];if("|"===k)d(this._tpl.separator).appendTo(this.menuEl);else{var h=d(this._tpl.menuItem).appendTo(this.menuEl);h=h.find("a.menu-item").attr({title:null!=(b=k.title)?b:k.text,"data-param":k.param}).addClass("menu-item-"+k.name);k.icon?g.push(h.find("span").addClass(this.iconClassOf(k.icon))):g.push(h.find("span").text(k.text))}}return g}};b.prototype.setActive=function(a){if(a!==this.active)return this.active=a,this.el.toggleClass("active",
this.active)};b.prototype.setDisabled=function(a){if(a!==this.disabled)return this.disabled=a,this.el.toggleClass("disabled",this.disabled)};b.prototype._disableStatus=function(){var a=this.editor.selection.startNodes();var b=this.editor.selection.endNodes();b=0<a.filter(this.disableTag).length||0<b.filter(this.disableTag).length;this.setDisabled(b);this.disabled&&this.setActive(!1);return this.disabled};b.prototype._activeStatus=function(){var a=this.editor.selection.startNodes();var b=this.editor.selection.endNodes();
a=a.filter(this.htmlTag);b=b.filter(this.htmlTag);this.node=(b=0<a.length&&0<b.length&&a.is(b))?a:null;this.setActive(b);return this.active};b.prototype._status=function(){this._disableStatus();if(!this.disabled)return this._activeStatus()};b.prototype.command=function(a){};b.prototype._t=function(){var a;var c=1<=arguments.length?w.call(arguments,0):[];var e=b.__super__._t.apply(this,c);e||(e=(a=this.editor)._t.apply(a,c));return e};return b}(m);q.Button=v;m=function(l){function b(a){this.button=
a.button;this.editor=a.button.editor;b.__super__.constructor.call(this,a)}n(b,l);b.prototype.offset={top:4,left:0};b.prototype.target=null;b.prototype.active=!1;b.prototype._init=function(){this.el=d('<div class="simditor-popover"></div>').appendTo(this.editor.el).data("popover",this);this.render();this.el.on("mouseenter",function(a){return function(b){return a.el.addClass("hover")}}(this));return this.el.on("mouseleave",function(a){return function(b){return a.el.removeClass("hover")}}(this))};b.prototype.render=
function(){};b.prototype._initLabelWidth=function(){var a=this.el.find(".settings-field");if(0<a.length)return this._labelWidth=0,a.each(function(a){return function(b,c){b=d(c).find("label");if(0<b.length)return a._labelWidth=Math.max(a._labelWidth,b.width())}}(this)),a.find("label").width(this._labelWidth)};b.prototype.show=function(a,b){null==b&&(b="bottom");if(null!=a)return this.el.siblings(".simditor-popover").each(function(a,b){b=d(b).data("popover");if(b.active)return b.hide()}),this.active&&
this.target&&this.target.removeClass("selected"),this.target=a.addClass("selected"),this.active||(this.active=!0,this.el.css({left:-9999}).show(),this._labelWidth||this._initLabelWidth(),this.editor.util.reflow()),this.refresh(b),this.trigger("popovershow")};b.prototype.hide=function(){if(this.active)return this.target&&this.target.removeClass("selected"),this.target=null,this.active=!1,this.el.hide(),this.trigger("popoverhide")};b.prototype.refresh=function(a){var b;null==a&&(a="bottom");if(this.active){var e=
this.editor.el.offset();var d=this.target.offset();var f=this.target.outerHeight();"bottom"===a?b=d.top-e.top+f:"top"===a&&(b=d.top-e.top-this.el.height());a=this.editor.wrapper.width()-this.el.outerWidth()-10;return this.el.css({top:b+this.offset.top,left:Math.min(d.left-e.left,a)+this.offset.left})}};b.prototype.destroy=function(){this.target=null;this.active=!1;this.editor.off(".linkpopover");return this.el.remove()};b.prototype._t=function(){var a;var c=1<=arguments.length?w.call(arguments,0):
[];var e=b.__super__._t.apply(this,c);e||(e=(a=this.button)._t.apply(a,c));return e};return b}(m);q.Popover=m;var r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="title";b.prototype.htmlTag="h1, h2, h3, h4, h5";b.prototype.disableTag="pre, table";b.prototype._init=function(){this.menu=[{name:"normal",text:this._t("normalText"),param:"p"},"|",{name:"h1",text:this._t("title")+" 1",param:"h1"},{name:"h2",text:this._t("title")+" 2",param:"h2"},{name:"h3",
text:this._t("title")+" 3",param:"h3"},{name:"h4",text:this._t("title")+" 4",param:"h4"},{name:"h5",text:this._t("title")+" 5",param:"h5"}];return b.__super__._init.call(this)};b.prototype.setActive=function(a,c){b.__super__.setActive.call(this,a);a&&(c||(c=this.node[0].tagName.toLowerCase()));this.el.removeClass("active-p active-h1 active-h2 active-h3 active-h4 active-h5");if(a)return this.el.addClass("active active-"+c)};b.prototype.command=function(a){var b=this.editor.selection.rootNodes();this.editor.selection.save();
b.each(function(b){return function(c,e){c=d(e);if(!(c.is("blockquote")||c.is(a)||c.is(b.disableTag)||b.editor.util.isDecoratedNode(c)))return d("<"+a+"/>").append(c.contents()).replaceAll(c)}}(this));this.editor.selection.restore();return this.editor.trigger("valuechanged")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="fontScale";b.prototype.icon="font";b.prototype.htmlTag="span";b.prototype.disableTag=
"pre, h1, h2, h3, h4, h5";b.prototype.sizeMap={"x-large":"1.5em",large:"1.25em",small:".75em","x-small":".5em"};b.prototype._init=function(){this.menu=[{name:"150%",text:this._t("fontScaleXLarge"),param:"5"},{name:"125%",text:this._t("fontScaleLarge"),param:"4"},{name:"100%",text:this._t("fontScaleNormal"),param:"3"},{name:"75%",text:this._t("fontScaleSmall"),param:"2"},{name:"50%",text:this._t("fontScaleXSmall"),param:"1"}];return b.__super__._init.call(this)};b.prototype._activeStatus=function(){this.editor.selection.range();
var a=this.editor.selection.startNodes();var b=this.editor.selection.endNodes();var e=a.filter('span[style*="font-size"]');var d=b.filter('span[style*="font-size"]');d=0<a.length&&0<b.length&&e.is(d);this.setActive(d);return this.active};b.prototype.command=function(a){var b=this.editor.selection.range();if(!b.collapsed)return this.editor.selection.range(b),document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,a),document.execCommand("styleWithCSS",!1,!1),this.editor.selection.reset(),
this.editor.selection.range(),a=this.editor.selection.containerNode(),a=a[0].nodeType===Node.TEXT_NODE?a.closest('span[style*="font-size"]'):a.find('span[style*="font-size"]'),a.each(function(a){return function(b,c){b=d(c);c=c.style.fontSize;if(/large|x-large|small|x-small/.test(c))return b.css("fontSize",a.sizeMap[c]);if("medium"===c)return 1<b[0].style.length?b.css("fontSize",""):b.replaceWith(b.contents())}}(this)),this.editor.trigger("valuechanged")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,
arguments)}n(b,l);b.prototype.name="bold";b.prototype.icon="bold";b.prototype.htmlTag="b, strong";b.prototype.disableTag="pre";b.prototype.shortcut="cmd+b";b.prototype._init=function(){this.editor.util.os.mac?this.title+=" ( Cmd + b )":(this.title+=" ( Ctrl + b )",this.shortcut="ctrl+b");return b.__super__._init.call(this)};b.prototype._activeStatus=function(){var a=!0===document.queryCommandState("bold");this.setActive(a);return this.active};b.prototype.command=function(){document.execCommand("bold");
this.editor.util.support.oninput||this.editor.trigger("valuechanged");return d(document).trigger("selectionchange")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="italic";b.prototype.icon="italic";b.prototype.htmlTag="i";b.prototype.disableTag="pre";b.prototype.shortcut="cmd+i";b.prototype._init=function(){this.editor.util.os.mac?this.title+=" ( Cmd + i )":(this.title+=" ( Ctrl + i )",this.shortcut="ctrl+i");
return b.__super__._init.call(this)};b.prototype._activeStatus=function(){var a=!0===document.queryCommandState("italic");this.setActive(a);return this.active};b.prototype.command=function(){document.execCommand("italic");this.editor.util.support.oninput||this.editor.trigger("valuechanged");return d(document).trigger("selectionchange")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="underline";b.prototype.icon=
"underline";b.prototype.htmlTag="u";b.prototype.disableTag="pre";b.prototype.shortcut="cmd+u";b.prototype.render=function(){this.editor.util.os.mac?this.title+=" ( Cmd + u )":(this.title+=" ( Ctrl + u )",this.shortcut="ctrl+u");return b.__super__.render.call(this)};b.prototype._activeStatus=function(){var a=!0===document.queryCommandState("underline");this.setActive(a);return this.active};b.prototype.command=function(){document.execCommand("underline");this.editor.util.support.oninput||this.editor.trigger("valuechanged");
return d(document).trigger("selectionchange")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="color";b.prototype.icon="tint";b.prototype.disableTag="pre";b.prototype.menu=!0;b.prototype.render=function(){var a=1<=arguments.length?w.call(arguments,0):[];return b.__super__.render.apply(this,a)};b.prototype.renderMenu=function(){d('<ul class="color-list">\n  <li><a href="javascript:;" class="font-color font-color-1"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-2"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-3"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-4"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-5"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-6"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-7"></a></li>\n  <li><a href="javascript:;" class="font-color font-color-default"></a></li>\n</ul>').appendTo(this.menuWrapper);
this.menuWrapper.on("mousedown",".color-list",function(a){return!1});return this.menuWrapper.on("click",".font-color",function(a){return function(b){a.wrapper.removeClass("menu-on");b=d(b.currentTarget);if(b.hasClass("font-color-default")){var c=a.editor.body.find("p, li");if(!(0<c.length))return;c=window.getComputedStyle(c[0],null).getPropertyValue("color")}else c=window.getComputedStyle(b[0],null).getPropertyValue("background-color");if(c=a._convertRgbToHex(c)){var g=a.editor.selection.range();
!b.hasClass("font-color-default")&&g.collapsed&&(b=document.createTextNode(a._t("coloredText")),g.insertNode(b),g.selectNodeContents(b));a.editor.selection.range(g);document.execCommand("styleWithCSS",!1,!0);document.execCommand("foreColor",!1,c);document.execCommand("styleWithCSS",!1,!1);if(!a.editor.util.support.oninput)return a.editor.trigger("valuechanged")}}}(this))};b.prototype._convertRgbToHex=function(a){return(a=/rgb\((\d+),\s?(\d+),\s?(\d+)\)/g.exec(a))?function(a,b,d){var c=function(a){a=
a.toString(16);return 1===a.length?"0"+a:a};return"#"+c(a)+c(b)+c(d)}(1*a[1],1*a[2],1*a[3]):""};return b}(v);q.Toolbar.addButton(r);var A=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.type="";b.prototype.disableTag="pre, table";b.prototype.command=function(a){a=this.editor.selection.blockNodes();var b="ul"===this.type?"ol":"ul";this.editor.selection.save();var e=null;a.each(function(a){return function(c,g){var f=d(g);if(!(f.is("blockquote, li")||
f.is(a.disableTag)||a.editor.util.isDecoratedNode(f))&&d.contains(document,g)){if(f.is(a.type))return f.children("li").each(function(b,c){d(c).children("ul, ol").insertAfter(f);return d("<p/>").append(d(c).html()||a.editor.util.phBr).insertBefore(f)}),f.remove();if(f.is(b))return d("<"+a.type+"/>").append(f.contents()).replaceAll(f);if(e&&f.prev().is(e))return d("<li/>").append(f.html()||a.editor.util.phBr).appendTo(e),f.remove();e=d("<"+a.type+"><li></li></"+a.type+">");e.find("li").append(f.html()||
a.editor.util.phBr);return e.replaceAll(f)}}}(this));this.editor.selection.restore();return this.editor.trigger("valuechanged")};return b}(v);r=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,d);b.prototype.type="ol";b.prototype.name="ol";b.prototype.icon="list-ol";b.prototype.htmlTag="ol";b.prototype.shortcut="cmd+/";b.prototype._init=function(){this.editor.util.os.mac?this.title+=" ( Cmd + / )":(this.title+=" ( ctrl + / )",this.shortcut="ctrl+/");return b.__super__._init.call(this)};
return b}(A);A=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,d);b.prototype.type="ul";b.prototype.name="ul";b.prototype.icon="list-ul";b.prototype.htmlTag="ul";b.prototype.shortcut="cmd+.";b.prototype._init=function(){this.editor.util.os.mac?this.title+=" ( Cmd + . )":(this.title+=" ( Ctrl + . )",this.shortcut="ctrl+.");return b.__super__._init.call(this)};return b}(A);q.Toolbar.addButton(r);q.Toolbar.addButton(A);r=function(l){function b(){return b.__super__.constructor.apply(this,
arguments)}n(b,l);b.prototype.name="blockquote";b.prototype.icon="quote-left";b.prototype.htmlTag="blockquote";b.prototype.disableTag="pre, table";b.prototype.command=function(){var a=this.editor.selection.rootNodes();a=a.filter(function(a,b){return!d(b).parent().is("blockquote")});this.editor.selection.save();var b=[];var e=function(a){return function(){if(0<b.length)return d("<"+a.htmlTag+"/>").insertBefore(b[0]).append(b),b.length=0}}(this);a.each(function(a){return function(c,g){c=d(g);if(c.parent().is(a.editor.body))return c.is(a.htmlTag)?
(e(),c.children().unwrap()):c.is(a.disableTag)||a.editor.util.isDecoratedNode(c)?e():b.push(g)}}(this));e();this.editor.selection.restore();return this.editor.trigger("valuechanged")};return b}(v);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="code";b.prototype.icon="code";b.prototype.htmlTag="pre";b.prototype.disableTag="ul, ol, table";b.prototype._init=function(){b.__super__._init.call(this);this.editor.on("decorate",
function(a){return function(b,e){return e.find("pre").each(function(b,c){return a.decorate(d(c))})}}(this));return this.editor.on("undecorate",function(a){return function(b,e){return e.find("pre").each(function(b,c){return a.undecorate(d(c))})}}(this))};b.prototype.render=function(){var a=1<=arguments.length?w.call(arguments,0):[];b.__super__.render.apply(this,a);return this.popover=new L({button:this})};b.prototype._checkMode=function(){var a=this.editor.selection.range();if(0<d(a.cloneContents()).find(this.editor.util.blockNodes.join(","))||
a.collapsed&&0===this.editor.selection.startNodes().filter("code").length)return this.inlineMode=!1,this.htmlTag="pre";this.inlineMode=!0;return this.htmlTag="code"};b.prototype._status=function(){this._checkMode();b.__super__._status.call(this);if(!this.inlineMode)return this.active?this.popover.show(this.node):this.popover.hide()};b.prototype.decorate=function(a){var b,e;var d=a.find("> code");if(0<d.length){var f=null!=(b=d.attr("class"))?null!=(e=b.match(/lang-(\S+)/))?e[1]:void 0:void 0;d.contents().unwrap();
if(f)return a.attr("data-lang",f)}};b.prototype.undecorate=function(a){var b=a.attr("data-lang");var e=d("<code/>");b&&-1!==b&&e.addClass("lang-"+b);return a.wrapInner(e).removeAttr("data-lang")};b.prototype.command=function(){return this.inlineMode?this._inlineCommand():this._blockCommand()};b.prototype._blockCommand=function(){var a=this.editor.selection.rootNodes();var b=[];var e=[];var g=function(a){return function(){if(0<b.length){var c=d("<"+a.htmlTag+"/>").insertBefore(b[0]).text(a.editor.formatter.clearHtml(b));
e.push(c[0]);return b.length=0}}}(this);a.each(function(a){return function(c,f){c=d(f);return c.is(a.htmlTag)?(g(),f=d("<p/>").append(c.html().replace("\n","<br/>")).replaceAll(c),e.push(f[0])):c.is(a.disableTag)||a.editor.util.isDecoratedNode(c)||c.is("blockquote")?g():b.push(f)}}(this));g();this.editor.selection.setRangeAtEndOf(d(e).last());return this.editor.trigger("valuechanged")};b.prototype._inlineCommand=function(){var a=this.editor.selection.range();if(this.active)a.selectNodeContents(this.node[0]),
this.editor.selection.save(a),this.node.contents().unwrap(),this.editor.selection.restore();else{var b=d(a.extractContents());b=d("<"+this.htmlTag+"/>").append(b.contents());a.insertNode(b[0]);a.selectNodeContents(b[0]);this.editor.selection.range(a)}return this.editor.trigger("valuechanged")};return b}(v);var L=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.render=function(){var a;this._tpl='<div class="code-settings">\n  <div class="settings-field">\n    <select class="select-lang">\n      <option value="-1">'+
this._t("selectLanguage")+"</option>\n    </select>\n  </div>\n</div>";this.langs=this.editor.opts.codeLanguages||[{name:"Bash",value:"bash"},{name:"C++",value:"c++"},{name:"C#",value:"cs"},{name:"CSS",value:"css"},{name:"Erlang",value:"erlang"},{name:"Less",value:"less"},{name:"Sass",value:"sass"},{name:"Diff",value:"diff"},{name:"CoffeeScript",value:"coffeescript"},{name:"HTML,XML",value:"html"},{name:"JSON",value:"json"},{name:"Java",value:"java"},{name:"JavaScript",value:"js"},{name:"Markdown",
value:"markdown"},{name:"Objective C",value:"oc"},{name:"PHP",value:"php"},{name:"Perl",value:"parl"},{name:"Python",value:"python"},{name:"Ruby",value:"ruby"},{name:"SQL",value:"sql"}];this.el.addClass("code-popover").append(this._tpl);this.selectEl=this.el.find(".select-lang");var b=this.langs;var e=0;for(a=b.length;e<a;e++){var g=b[e];d("<option/>",{text:g.name,value:g.value}).appendTo(this.selectEl)}this.selectEl.on("change",function(a){return function(b){a.lang=a.selectEl.val();b=a.target.hasClass("selected");
a.target.removeClass().removeAttr("data-lang");-1!==a.lang&&a.target.attr("data-lang",a.lang);b&&a.target.addClass("selected");return a.editor.trigger("valuechanged")}}(this));return this.editor.on("valuechanged",function(a){return function(b){if(a.active)return a.refresh()}}(this))};b.prototype.show=function(){var a=1<=arguments.length?w.call(arguments,0):[];b.__super__.show.apply(this,a);this.lang=this.target.attr("data-lang");return null!=this.lang?this.selectEl.val(this.lang):this.selectEl.val(-1)};
return b}(m);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="link";b.prototype.icon="link";b.prototype.htmlTag="a";b.prototype.disableTag="pre";b.prototype.render=function(){var a=1<=arguments.length?w.call(arguments,0):[];b.__super__.render.apply(this,a);return this.popover=new M({button:this})};b.prototype._status=function(){b.__super__._status.call(this);return this.active&&!this.editor.selection.rangeAtEndOf(this.node)?
this.popover.show(this.node):this.popover.hide()};b.prototype.command=function(){var a=this.editor.selection.range();if(this.active){var b=document.createTextNode(this.node.text());this.node.replaceWith(b);a.selectNode(b)}else{b=d(a.extractContents());var e=this.editor.formatter.clearHtml(b.contents(),!1);b=d("<a/>",{href:"",target:"_blank",text:e||this._t("linkText")});if(0<this.editor.selection.blockNodes().length)a.insertNode(b[0]);else{var g=d("<p/>").append(b);a.insertNode(g[0])}a.selectNodeContents(b[0]);
this.popover.one("popovershow",function(a){return function(){if(e)return a.popover.urlEl.focus(),a.popover.urlEl[0].select();a.popover.textEl.focus();return a.popover.textEl[0].select()}}(this))}this.editor.selection.range(a);return this.editor.trigger("valuechanged")};return b}(v);var M=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.render=function(){var a='<div class="link-settings">\n  <div class="settings-field">\n    <label>'+this._t("linkText")+
'</label>\n    <input class="link-text" type="text"/>\n    <a class="btn-unlink" href="javascript:;" title="'+this._t("removeLink")+'"\n      tabindex="-1">\n      <span class="simditor-icon simditor-icon-unlink"></span>\n    </a>\n  </div>\n  <div class="settings-field">\n    <label>'+this._t("linkUrl")+'</label>\n    <input class="link-url" type="text"/>\n  </div>\n  <div class="settings-field">\n    <label>'+this._t("linkTarget")+'</label>\n    <select class="link-target">\n      <option value="_blank">'+
this._t("openLinkInNewWindow")+' (_blank)</option>\n      <option value="_self">'+this._t("openLinkInCurrentWindow")+" (_self)</option>\n    </select>\n  </div>\n</div>";this.el.addClass("link-popover").append(a);this.textEl=this.el.find(".link-text");this.urlEl=this.el.find(".link-url");this.unlinkEl=this.el.find(".btn-unlink");this.selectTarget=this.el.find(".link-target");this.textEl.on("keyup",function(a){return function(b){if(13!==b.which)return a.target.text(a.textEl.val()),a.editor.inputManager.throttledValueChanged()}}(this));
this.urlEl.on("keyup",function(a){return function(b){if(13!==b.which)return b=a.urlEl.val(),!/https?:\/\/|^\//ig.test(b)&&b&&(b="http://"+b),a.target.attr("href",b),a.editor.inputManager.throttledValueChanged()}}(this));d([this.urlEl[0],this.textEl[0]]).on("keydown",function(a){return function(b){if(13===b.which||27===b.which||!b.shiftKey&&9===b.which&&d(b.target).hasClass("link-url"))return b.preventDefault(),b=document.createRange(),a.editor.selection.setRangeAfter(a.target,b),a.hide(),a.editor.inputManager.throttledValueChanged()}}(this));
this.unlinkEl.on("click",function(a){return function(b){var c=document.createTextNode(a.target.text());a.target.replaceWith(c);a.hide();b=document.createRange();a.editor.selection.setRangeAfter(c,b);return a.editor.inputManager.throttledValueChanged()}}(this));return this.selectTarget.on("change",function(a){return function(b){a.target.attr("target",a.selectTarget.val());return a.editor.inputManager.throttledValueChanged()}}(this))};b.prototype.show=function(){var a=1<=arguments.length?w.call(arguments,
0):[];b.__super__.show.apply(this,a);this.textEl.val(this.target.text());return this.urlEl.val(this.target.attr("href"))};return b}(m);q.Toolbar.addButton(r);r=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="image";b.prototype.icon="picture-o";b.prototype.htmlTag="img";b.prototype.disableTag="pre, table";b.prototype.defaultImage="";b.prototype.needFocus=!1;b.prototype._init=function(){var a;if(this.editor.opts.imageButton)if(Array.isArray(this.editor.opts.imageButton)){this.menu=
[];var c=this.editor.opts.imageButton;var e=0;for(a=c.length;e<a;e++){var g=c[e];this.menu.push({name:g+"-image",text:this._t(g+"Image")})}}else this.menu=!1;else this.menu=null!=this.editor.uploader?[{name:"upload-image",text:this._t("uploadImage")},{name:"external-image",text:this._t("externalImage")}]:!1;this.defaultImage=this.editor.opts.defaultImage;this.editor.body.on("click","img:not([data-non-image])",function(a){return function(b){b=d(b.currentTarget);var c=document.createRange();c.selectNode(b[0]);
a.editor.selection.range(c);a.editor.util.support.onselectionchange||a.editor.trigger("selectionchanged");return!1}}(this));this.editor.body.on("mouseup","img:not([data-non-image])",function(a){return!1});this.editor.on("selectionchanged.image",function(a){return function(){var b=a.editor.selection.range();if(null!=b){var c=d(b.cloneContents()).contents();return 1===c.length&&c.is("img:not([data-non-image])")?(c=d(b.startContainer).contents().eq(b.startOffset),a.popover.show(c)):a.popover.hide()}}}(this));
this.editor.on("valuechanged.image",function(a){return function(){var b=a.editor.wrapper.find(".simditor-image-loading");if(0<b.length)return b.each(function(b,c){c=d(c);b=c.data("img");if(!(b&&0<b.parent().length)&&(c.remove(),b&&(b=b.data("file")))&&(a.editor.uploader.cancel(b),1>a.editor.body.find("img.uploading").length))return a.editor.uploader.trigger("uploadready",[b])})}}(this));return b.__super__._init.call(this)};b.prototype.render=function(){var a=1<=arguments.length?w.call(arguments,0):
[];b.__super__.render.apply(this,a);this.popover=new N({button:this});if("upload"===this.editor.opts.imageButton)return this._initUploader(this.el)};b.prototype.renderMenu=function(){b.__super__.renderMenu.call(this);return this._initUploader()};b.prototype._initUploader=function(a){null==a&&(a=this.menuEl.find(".menu-item-upload-image"));if(null==this.editor.uploader)this.el.find(".btn-upload").remove();else{var b=null;var e=function(c){return function(){b&&b.remove();return b=d("<input/>",{type:"file",
title:c._t("uploadImage"),multiple:!0,accept:"image/gif,image/jpeg,image/jpg,image/png,image/svg"}).appendTo(a)}}(this);e();a.on("click mousedown","input[type=file]",function(a){return a.stopPropagation()});a.on("change","input[type=file]",function(a){return function(c){a.editor.inputManager.focused?(a.editor.uploader.upload(b,{inline:!0}),e()):(a.editor.one("focus",function(c){a.editor.uploader.upload(b,{inline:!0});return e()}),a.editor.focus());return a.wrapper.removeClass("menu-on")}}(this));
this.editor.uploader.on("beforeupload",function(a){return function(b,c){if(c.inline){if(c.img)var e=d(c.img);else e=a.createImage(c.name),c.img=e;e.addClass("uploading");e.data("file",c);return a.editor.uploader.readImageFile(c.obj,function(b){if(e.hasClass("uploading"))return a.loadImage(e,b?b.src:a.defaultImage,function(){if(a.popover.active)return a.popover.refresh(),a.popover.srcEl.val(a._t("uploading")).prop("disabled",!0)})})}}}(this));var g=d.proxy(this.editor.util.throttle(function(a,b,c,
e){if(b.inline&&(a=b.img.data("mask"))){b=a.data("img");if(b.hasClass("uploading")&&0<b.parent().length)return c=(c/e*100).toFixed(0),99<c&&(c=99),a.find(".progress").height(100-c+"%");a.remove()}},500),this);this.editor.uploader.on("uploadprogress",g);this.editor.uploader.on("uploadsuccess",function(a){return function(b,c,e){if(c.inline){var f=c.img;if(f.hasClass("uploading")&&0<f.parent().length){if("object"!==typeof e)try{e=d.parseJSON(e)}catch(z){e={success:!1}}!1===e.success?(b=e.msg||a._t("uploadFailed"),
alert(b),b=a.defaultImage):b=e.file_path;a.loadImage(f,b,function(){var b;f.removeData("file");f.removeClass("uploading").removeClass("loading");(b=f.data("mask"))&&b.remove();f.removeData("mask");a.editor.trigger("valuechanged");if(1>a.editor.body.find("img.uploading").length)return a.editor.uploader.trigger("uploadready",[c,e])});if(a.popover.active)return a.popover.srcEl.prop("disabled",!1),a.popover.srcEl.val(e.file_path)}}}}(this));return this.editor.uploader.on("uploaderror",function(a){return function(b,
c,e){if(c.inline&&"abort"!==e.statusText){if(e.responseText)try{var f=d.parseJSON(e.responseText)}catch(B){a._t("uploadError")}var g=c.img;if(g.hasClass("uploading")&&0<g.parent().length&&(a.loadImage(g,a.defaultImage,function(){var a;g.removeData("file");g.removeClass("uploading").removeClass("loading");(a=g.data("mask"))&&a.remove();return g.removeData("mask")}),a.popover.active&&(a.popover.srcEl.prop("disabled",!1),a.popover.srcEl.val(a.defaultImage)),a.editor.trigger("valuechanged"),1>a.editor.body.find("img.uploading").length))return a.editor.uploader.trigger("uploadready",
[c,f])}}}(this))}};b.prototype._status=function(){return this._disableStatus()};b.prototype.loadImage=function(a,b,e){var c=function(b){return function(){var c=a.offset();var e=b.editor.wrapper.offset();return f.css({top:c.top-e.top,left:c.left-e.left,width:a.width(),height:a.height()}).show()}}(this);a.addClass("loading");var f=a.data("mask");f||(f=d('<div class="simditor-image-loading">\n  <div class="progress"></div>\n</div>').hide().appendTo(this.editor.wrapper),c(),a.data("mask",f),f.data("img",
a));var k=new Image;k.onload=function(g){return function(){if(a.hasClass("loading")||a.hasClass("uploading")){var h=k.width;var l=k.height;a.attr({src:b,width:h,height:l,"data-image-size":h+","+l}).removeClass("loading");a.hasClass("uploading")?(g.editor.util.reflow(g.editor.body),c()):(f.remove(),a.removeData("mask"));if(d.isFunction(e))return e(k)}}}(this);k.onerror=function(){d.isFunction(e)&&e(!1);f.remove();return a.removeData("mask").removeClass("loading")};return k.src=b};b.prototype.createImage=
function(a){null==a&&(a="Image");this.editor.inputManager.focused||this.editor.focus();var b=this.editor.selection.range();b.deleteContents();this.editor.selection.range(b);a=d("<img/>").attr("alt",a);b.insertNode(a[0]);this.editor.selection.setRangeAfter(a,b);this.editor.trigger("valuechanged");return a};b.prototype.command=function(a){var b=this.createImage();return this.loadImage(b,a||this.defaultImage,function(a){return function(){a.editor.trigger("valuechanged");a.editor.util.reflow(b);b.click();
return a.popover.one("popovershow",function(){a.popover.srcEl.focus();return a.popover.srcEl[0].select()})}}(this))};return b}(v);var N=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.offset={top:6,left:-4};b.prototype.render=function(){var a='<div class="link-settings">\n  <div class="settings-field">\n    <label>'+this._t("imageUrl")+'</label>\n    <input class="image-src" type="text" tabindex="1" />\n    <a class="btn-upload" href="javascript:;"\n      title="'+
this._t("uploadImage")+'" tabindex="-1">\n      <span class="simditor-icon simditor-icon-upload"></span>\n    </a>\n  </div>\n  <div class=\'settings-field\'>\n    <label>'+this._t("imageAlt")+'</label>\n    <input class="image-alt" id="image-alt" type="text" tabindex="1" />\n  </div>\n  <div class="settings-field">\n    <label>'+this._t("imageSize")+'</label>\n    <input class="image-size" id="image-width" type="text" tabindex="2" />\n    <span class="times">\u00d7</span>\n    <input class="image-size" id="image-height" type="text" tabindex="3" />\n    <a class="btn-restore" href="javascript:;"\n      title="'+
this._t("restoreImageSize")+'" tabindex="-1">\n      <span class="simditor-icon simditor-icon-undo"></span>\n    </a>\n  </div>\n</div>';this.el.addClass("image-popover").append(a);this.srcEl=this.el.find(".image-src");this.widthEl=this.el.find("#image-width");this.heightEl=this.el.find("#image-height");this.altEl=this.el.find("#image-alt");this.srcEl.on("keydown",function(a){return function(b){if(13===b.which&&!a.target.hasClass("uploading"))return b.preventDefault(),b=document.createRange(),a.button.editor.selection.setRangeAfter(a.target,
b),a.hide()}}(this));this.srcEl.on("blur",function(a){return function(b){return a._loadImage(a.srcEl.val())}}(this));this.el.find(".image-size").on("blur",function(a){return function(b){a._resizeImg(d(b.currentTarget));return a.el.data("popover").refresh()}}(this));this.el.find(".image-size").on("keyup",function(a){return function(b){var c=d(b.currentTarget);if(13!==b.which&&27!==b.which&&9!==b.which)return a._resizeImg(c,!0)}}(this));this.el.find(".image-size").on("keydown",function(a){return function(b){var c=
d(b.currentTarget);if(13===b.which||27===b.which)return b.preventDefault(),13===b.which?a._resizeImg(c):a._restoreImg(),b=a.target,a.hide(),c=document.createRange(),a.button.editor.selection.setRangeAfter(b,c);if(9===b.which)return a.el.data("popover").refresh()}}(this));this.altEl.on("keydown",function(a){return function(b){if(13===b.which)return b.preventDefault(),b=document.createRange(),a.button.editor.selection.setRangeAfter(a.target,b),a.hide()}}(this));this.altEl.on("keyup",function(a){return function(b){if(13!==
b.which&&27!==b.which&&9!==b.which)return a.alt=a.altEl.val(),a.target.attr("alt",a.alt)}}(this));this.el.find(".btn-restore").on("click",function(a){return function(b){a._restoreImg();return a.el.data("popover").refresh()}}(this));this.editor.on("valuechanged",function(a){return function(b){if(a.active)return a.refresh()}}(this));return this._initUploader()};b.prototype._initUploader=function(){var a=this.el.find(".btn-upload");if(null==this.editor.uploader)a.remove();else{var b=function(b){return function(){b.input&&
b.input.remove();return b.input=d("<input/>",{type:"file",title:b._t("uploadImage"),multiple:!0,accept:"image/gif,image/jpeg,image/jpg,image/png,image/svg"}).appendTo(a)}}(this);b();this.el.on("click mousedown","input[type=file]",function(a){return a.stopPropagation()});return this.el.on("change","input[type=file]",function(a){return function(c){a.editor.uploader.upload(a.input,{inline:!0,img:a.target});return b()}}(this))}};b.prototype._resizeImg=function(a,b){null==b&&(b=!1);var c=1*a.val();if(this.target&&
(d.isNumeric(c)||0>c)){if(a.is(this.widthEl)){var g=c;a=this.height*c/this.width;this.heightEl.val(a)}else a=c,g=this.width*c/this.height,this.widthEl.val(g);if(!b)return this.target.attr({width:g,height:a}),this.editor.trigger("valuechanged")}};b.prototype._restoreImg=function(){var a;var b=(null!=(a=this.target.data("image-size"))?a.split(","):void 0)||[this.width,this.height];this.target.attr({width:1*b[0],height:1*b[1]});this.widthEl.val(b[0]);this.heightEl.val(b[1]);return this.editor.trigger("valuechanged")};
b.prototype._loadImage=function(a,b){if(/^data:image/.test(a)&&!this.editor.uploader)b&&b(!1);else if(this.target.attr("src")!==a)return this.button.loadImage(this.target,a,function(c){return function(e){if(e){c.active&&(c.width=e.width,c.height=e.height,c.widthEl.val(c.width),c.heightEl.val(c.height));if(/^data:image/.test(a)){var d=c.editor.util.dataURLtoBlob(a);d.name="Base64 Image.png";c.editor.uploader.upload(d,{inline:!0,img:c.target})}else c.editor.trigger("valuechanged");if(b)return b(e)}}}(this))};
b.prototype.show=function(){var a=1<=arguments.length?w.call(arguments,0):[];b.__super__.show.apply(this,a);a=this.target;this.width=a.width();this.height=a.height();this.alt=a.attr("alt");if(a.hasClass("uploading"))return this.srcEl.val(this._t("uploading")).prop("disabled",!0);this.srcEl.val(a.attr("src")).prop("disabled",!1);this.widthEl.val(this.width);this.heightEl.val(this.height);return this.altEl.val(this.alt)};return b}(m);q.Toolbar.addButton(r);m=function(d){function b(){return b.__super__.constructor.apply(this,
arguments)}n(b,d);b.prototype.name="indent";b.prototype.icon="indent";b.prototype._init=function(){var a=!1===this.editor.opts.tabIndent?"":" (Tab)";this.title=this._t(this.name)+a;return b.__super__._init.call(this)};b.prototype._status=function(){};b.prototype.command=function(){return this.editor.indentation.indent()};return b}(v);q.Toolbar.addButton(m);m=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,d);b.prototype.name="outdent";b.prototype.icon="outdent";b.prototype._init=
function(){var a=!1===this.editor.opts.tabIndent?"":" (Shift + Tab)";this.title=this._t(this.name)+a;return b.__super__._init.call(this)};b.prototype._status=function(){};b.prototype.command=function(){return this.editor.indentation.indent(!0)};return b}(v);q.Toolbar.addButton(m);m=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="hr";b.prototype.icon="minus";b.prototype.htmlTag="hr";b.prototype._status=function(){};b.prototype.command=function(){var a;
var b=this.editor.selection.rootNodes().first();0<b.next().length?this.editor.selection.save():a=d("<p/>").append(this.editor.util.phBr);b=d("<hr/>").insertAfter(b);a?(a.insertAfter(b),this.editor.selection.setRangeAtStartOf(a)):this.editor.selection.restore();return this.editor.trigger("valuechanged")};return b}(v);q.Toolbar.addButton(m);m=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="table";b.prototype.icon="table";b.prototype.htmlTag="table";
b.prototype.disableTag="pre, li, blockquote";b.prototype.menu=!0;b.prototype._init=function(){b.__super__._init.call(this);d.merge(this.editor.formatter._allowedTags,"thead th tbody tr td colgroup col".split(" "));d.extend(this.editor.formatter._allowedAttributes,{td:["rowspan","colspan"],col:["width"]});d.extend(this.editor.formatter._allowedStyles,{td:["text-align"],th:["text-align"]});this._initShortcuts();this._initResize();this.editor.on("decorate",function(a){return function(b,e){return e.find("table").each(function(b,
c){return a.decorate(d(c))})}}(this));this.editor.on("undecorate",function(a){return function(b,e){return e.find("table").each(function(b,c){return a.undecorate(d(c))})}}(this));this.editor.on("selectionchanged.table",function(a){return function(b){var c;a.editor.body.find(".simditor-table td, .simditor-table th").removeClass("active");if(c=a.editor.selection.range())return b=a.editor.selection.containerNode(),c.collapsed&&b.is(".simditor-table")&&a.editor.selection.setRangeAtEndOf(b),b.closest("td, th",
a.editor.body).addClass("active")}}(this));this.editor.on("blur.table",function(a){return function(b){return a.editor.body.find(".simditor-table td, .simditor-table th").removeClass("active")}}(this));this.editor.keystroke.add("up","td",function(a){return function(b,e){a._tdNav(e,"up");return!0}}(this));this.editor.keystroke.add("up","th",function(a){return function(b,e){a._tdNav(e,"up");return!0}}(this));this.editor.keystroke.add("down","td",function(a){return function(b,e){a._tdNav(e,"down");return!0}}(this));
return this.editor.keystroke.add("down","th",function(a){return function(b,e){a._tdNav(e,"down");return!0}}(this))};b.prototype._tdNav=function(a,b){null==b&&(b="up");b="up"===b?"prev":"next";var c=a.parent("tr");b=this["_"+b+"Row"](c);if(!(0<b.length))return!0;a=c.find("td, th").index(a);return this.editor.selection.setRangeAtEndOf(b.find("td, th").eq(a))};b.prototype._nextRow=function(a){var b=a.next("tr");1>b.length&&0<a.parent("thead").length&&(b=a.parent("thead").next("tbody").find("tr:first"));
return b};b.prototype._prevRow=function(a){var b=a.prev("tr");1>b.length&&0<a.parent("tbody").length&&(b=a.parent("tbody").prev("thead").find("tr"));return b};b.prototype._initResize=function(){var a=this.editor;d(document).on("mousemove.simditor-table",".simditor-table td, .simditor-table th",function(a){var b,c;var f=d(this).parents(".simditor-table");var k=f.find(".simditor-resize-handle");var h=f.find("colgroup");if(!f.hasClass("resizing"))if(f=d(a.currentTarget),5>a.pageX-d(a.currentTarget).offset().left&&
0<f.prev().length&&(f=f.prev()),1>f.next("td, th").length)k.hide();else if(null!=(b=k.data("td"))&&b.is(f))k.show();else if(a=f.parent().find("td, th").index(f),h=h.find("col").eq(a),null!=(c=k.data("col"))&&c.is(h))k.show();else return k.css("left",f.position().left+f.outerWidth()-5).data("td",f).data("col",h).show()});d(document).on("mouseleave.simditor-table",".simditor-table",function(a){return d(this).find(".simditor-resize-handle").hide()});return d(document).on("mousedown.simditor-resize-handle",
".simditor-resize-handle",function(b){var c=d(this).parent(".simditor-table");var g=d(b.currentTarget);var f=g.data("td");var k=g.data("col");var h=f.next("td, th");var l=k.next("col");var m=b.pageX;var n=1*f.outerWidth();var q=1*h.outerWidth();var t=parseFloat(g.css("left"));var r=f.closest("table").width();d(document).on("mousemove.simditor-resize-table",function(a){a=a.pageX-m;var b=n+a;var c=q-a;50>b?(b=50,a=50-n,c=q-a):50>c&&(c=50,a=q-50,b=n+a);k.attr("width",b/r*100+"%");l.attr("width",c/r*
100+"%");return g.css("left",t+a)});d(document).one("mouseup.simditor-resize-table",function(b){a.sync();d(document).off(".simditor-resize-table");return c.removeClass("resizing")});c.addClass("resizing");return!1})};b.prototype._initShortcuts=function(){this.editor.hotkeys.add("ctrl+alt+up",function(a){return function(b){a.editMenu.find(".menu-item[data-param=insertRowAbove]").click();return!1}}(this));this.editor.hotkeys.add("ctrl+alt+down",function(a){return function(b){a.editMenu.find(".menu-item[data-param=insertRowBelow]").click();
return!1}}(this));this.editor.hotkeys.add("ctrl+alt+left",function(a){return function(b){a.editMenu.find(".menu-item[data-param=insertColLeft]").click();return!1}}(this));return this.editor.hotkeys.add("ctrl+alt+right",function(a){return function(b){a.editMenu.find(".menu-item[data-param=insertColRight]").click();return!1}}(this))};b.prototype.decorate=function(a){0<a.parent(".simditor-table").length&&this.undecorate(a);a.wrap('<div class="simditor-table"></div>');var b=a.parent(".simditor-table");
var e=a.find("colgroup");if(1>a.find("thead").length){var g=d("<thead />");var f=a.find("tr").first();g.append(f);this._changeCellTag(f,"th");f=a.find("tbody");0<f.length?f.before(g):a.prepend(g)}1>e.length&&(e=d("<colgroup/>").prependTo(a),a.find("thead tr th").each(function(a,b){return d("<col/>").appendTo(e)}),this.refreshTableWidth(a));d("<div />",{"class":"simditor-resize-handle",contenteditable:"false"}).appendTo(b);return a.parent()};b.prototype.undecorate=function(a){if(0<a.parent(".simditor-table").length)return a.parent().replaceWith(a)};
b.prototype.renderMenu=function(){d('<div class="menu-create-table">\n</div>\n<div class="menu-edit-table">\n  <ul>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="deleteRow">\n        <span>'+this._t("deleteRow")+'</span>\n      </a>\n    </li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="insertRowAbove">\n        <span>'+this._t("insertRowAbove")+' ( Ctrl + Alt + \u2191 )</span>\n      </a>\n    </li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="insertRowBelow">\n        <span>'+
this._t("insertRowBelow")+' ( Ctrl + Alt + \u2193 )</span>\n      </a>\n    </li>\n    <li><span class="separator"></span></li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="deleteCol">\n        <span>'+this._t("deleteColumn")+'</span>\n      </a>\n    </li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="insertColLeft">\n        <span>'+this._t("insertColumnLeft")+' ( Ctrl + Alt + \u2190 )</span>\n      </a>\n    </li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="insertColRight">\n        <span>'+
this._t("insertColumnRight")+' ( Ctrl + Alt + \u2192 )</span>\n      </a>\n    </li>\n    <li><span class="separator"></span></li>\n    <li>\n      <a tabindex="-1" unselectable="on" class="menu-item"\n        href="javascript:;" data-param="deleteTable">\n        <span>'+this._t("deleteTable")+"</span>\n      </a>\n    </li>\n  </ul>\n</div>").appendTo(this.menuWrapper);this.createMenu=this.menuWrapper.find(".menu-create-table");this.editMenu=this.menuWrapper.find(".menu-edit-table");var a=this.createTable(6,
6).appendTo(this.createMenu);this.createMenu.on("mouseenter","td, th",function(b){return function(c){b.createMenu.find("td, th").removeClass("selected");var e=d(c.currentTarget);c=e.parent();var f=c.find("td, th").index(e)+1;e=c.prevAll("tr").addBack();c.parent().is("tbody")&&(e=e.add(a.find("thead tr")));return e.find("td:lt("+f+"), th:lt("+f+")").addClass("selected")}}(this));this.createMenu.on("mouseleave",function(a){return d(a.currentTarget).find("td, th").removeClass("selected")});return this.createMenu.on("mousedown",
"td, th",function(b){return function(c){b.wrapper.removeClass("menu-on");if(b.editor.inputManager.focused){var e=d(c.currentTarget);c=e.parent();e=c.find("td").index(e)+1;var f=c.prevAll("tr").length+1;c.parent().is("tbody")&&(f+=1);a=b.createTable(f,e,!0);c=b.editor.selection.blockNodes().last();b.editor.util.isEmptyNode(c)?c.replaceWith(a):c.after(a);b.decorate(a);b.editor.selection.setRangeAtStartOf(a.find("th:first"));b.editor.trigger("valuechanged");return!1}}}(this))};b.prototype.createTable=
function(a,b,e){var c,f,k;var h=d("<table/>");var l=d("<thead/>").appendTo(h);var m=d("<tbody/>").appendTo(h);for(f=c=0;0<=a?c<a:c>a;f=0<=a?++c:--c){var n=d("<tr/>");n.appendTo(0===f?l:m);var q=0;for(k=b;0<=k?q<k:q>k;0<=k?++q:--q){var r=d(0===f?"<th/>":"<td/>").appendTo(n);e&&r.append(this.editor.util.phBr)}}return h};b.prototype.refreshTableWidth=function(a){return setTimeout(function(b){return function(){var b=a.width();var c=a.find("col");return a.find("thead tr th").each(function(a,e){return c.eq(a).attr("width",
d(e).outerWidth()/b*100+"%")})}}(this),0)};b.prototype.setActive=function(a){b.__super__.setActive.call(this,a);if(a)return this.createMenu.hide(),this.editMenu.show();this.createMenu.show();return this.editMenu.hide()};b.prototype._changeCellTag=function(a,b){return a.find("td, th").each(function(a,c){a=d(c);return a.replaceWith("<"+b+">"+a.html()+"</"+b+">")})};b.prototype.deleteRow=function(a){var b=a.parent("tr");if(1>b.closest("table").find("tr").length)return this.deleteTable(a);var d=this._nextRow(b);
0<d.length||(d=this._prevRow(b));a=b.find("td, th").index(a);b.parent().is("thead")&&(d.appendTo(b.parent()),this._changeCellTag(d,"th"));b.remove();return this.editor.selection.setRangeAtEndOf(d.find("td, th").eq(a))};b.prototype.insertRow=function(a,b){null==b&&(b="after");var c=a.parent("tr");var g=c.closest("table");var f=0;g.find("tr").each(function(a,b){return f=Math.max(f,d(b).find("td").length)});var k=c.find("td, th").index(a);a=d("<tr/>");g="td";if("after"===b&&c.parent().is("thead"))c.parent().next("tbody").prepend(a);
else if("before"===b&&c.parent().is("thead"))c.before(a),c.parent().next("tbody").prepend(c),this._changeCellTag(c,"td"),g="th";else c[b](a);b=1;for(c=f;1<=c?b<=c:b>=c;1<=c?++b:--b)d("<"+g+"/>").append(this.editor.util.phBr).appendTo(a);return this.editor.selection.setRangeAtStartOf(a.find("td, th").eq(k))};b.prototype.deleteCol=function(a){var b=a.parent("tr");var e=2>b.closest("table").find("tr").length;var g=1>a.siblings("td, th").length;if(e&&g)return this.deleteTable(a);var f=b.find("td, th").index(a);
a=a.next("td, th");0<a.length||(a=b.prev("td, th"));b=b.closest("table");b.find("col").eq(f).remove();b.find("tr").each(function(a,b){return d(b).find("td, th").eq(f).remove()});this.refreshTableWidth(b);return this.editor.selection.setRangeAtEndOf(a)};b.prototype.insertCol=function(a,b){null==b&&(b="after");var c=a.parent("tr").find("td, th").index(a);var g=a.closest("table");var f=g.find("col").eq(c);g.find("tr").each(function(a){return function(e,f){e=d(f).parent().is("thead")?"th":"td";e=d("<"+
e+"/>").append(a.editor.util.phBr);return d(f).find("td, th").eq(c)[b](e)}}(this));var k=d("<col/>");f[b](k);var h=g.width();h=Math.max(parseFloat(f.attr("width"))/2,50/h*100);f.attr("width",h+"%");k.attr("width",h+"%");this.refreshTableWidth(g);a="after"===b?a.next("td, th"):a.prev("td, th");return this.editor.selection.setRangeAtStartOf(a)};b.prototype.deleteTable=function(a){var b=a.closest(".simditor-table");a=b.next("p");b.remove();if(0<a.length)return this.editor.selection.setRangeAtStartOf(a)};
b.prototype.command=function(a){var b=this.editor.selection.containerNode().closest("td, th");if(0<b.length){if("deleteRow"===a)this.deleteRow(b);else if("insertRowAbove"===a)this.insertRow(b,"before");else if("insertRowBelow"===a)this.insertRow(b);else if("deleteCol"===a)this.deleteCol(b);else if("insertColLeft"===a)this.insertCol(b,"before");else if("insertColRight"===a)this.insertCol(b);else if("deleteTable"===a)this.deleteTable(b);else return;return this.editor.trigger("valuechanged")}};return b}(v);
q.Toolbar.addButton(m);m=function(l){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,l);b.prototype.name="strikethrough";b.prototype.icon="strikethrough";b.prototype.htmlTag="strike";b.prototype.disableTag="pre";b.prototype._activeStatus=function(){var a=!0===document.queryCommandState("strikethrough");this.setActive(a);return this.active};b.prototype.command=function(){document.execCommand("strikethrough");this.editor.util.support.oninput||this.editor.trigger("valuechanged");
return d(document).trigger("selectionchange")};return b}(v);q.Toolbar.addButton(m);v=function(d){function b(){return b.__super__.constructor.apply(this,arguments)}n(b,d);b.prototype.name="alignment";b.prototype.icon="align-left";b.prototype.htmlTag="p, h1, h2, h3, h4, td, th";b.prototype._init=function(){this.menu=[{name:"left",text:this._t("alignLeft"),icon:"align-left",param:"left"},{name:"center",text:this._t("alignCenter"),icon:"align-center",param:"center"},{name:"right",text:this._t("alignRight"),
icon:"align-right",param:"right"}];return b.__super__._init.call(this)};b.prototype.setActive=function(a,c){null==c&&(c="left");"left"!==c&&"center"!==c&&"right"!==c&&(c="left");"left"===c?b.__super__.setActive.call(this,!1):b.__super__.setActive.call(this,a);this.el.removeClass("align-left align-center align-right");a&&this.el.addClass("align-"+c);this.setIcon("align-"+c);return this.menuEl.find(".menu-item").show().end().find(".menu-item-"+c).hide()};b.prototype._status=function(){this.nodes=this.editor.selection.nodes().filter(this.htmlTag);
if(1>this.nodes.length)return this.setDisabled(!0),this.setActive(!1);this.setDisabled(!1);return this.setActive(!0,this.nodes.first().css("text-align"))};b.prototype.command=function(a){if("left"!==a&&"center"!==a&&"right"!==a)throw Error("simditor alignment button: invalid align "+a);this.nodes.css({"text-align":"left"===a?"":a});this.editor.trigger("valuechanged");return this.editor.inputManager.throttledSelectionChanged()};return b}(v);q.Toolbar.addButton(v);return q});
